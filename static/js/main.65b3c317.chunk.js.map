{"version":3,"sources":["components/RetractButton.js","components/MenuComponent.js","scripts/loadScenario.js","components/JsxMarker.js","components/LassoComponent.js","settings/mapProviders.js","scripts/generateUniqueID.js","assets/other/markerIcons.js","components/MapComponent.js","assets/other/defaultColors.js","components/ColorBarComponent.js","components/ToolbarComponent.js","plugins/LegendPlugin.js","plugins/RegionInfoPlugin.js","scripts/createScenarioEntry.js","plugins/AltHistEditorLoaderPlugin.js","assets/scenario/scenarios.js","assets/communityScenario/comScenarios.js","plugins/ScenarioPlugin.js","plugins/CustomGeoJSONLoaderPlugin.js","plugins/ThemePlugin.js","plugins/MarkerPlugin.js","appPlugins.js","components/PluginMenuComponent.js","components/TimelineAddButton.js","components/TimelineMarker.js","components/TimelineBarComponent.js","scripts/useWindowSize.js","components/TimelineEventComponent.js","components/PlayToolbarComponent.js","components/CondensedTimelineAddButton.js","components/CondensedTimelineDeleteButton.js","components/CondensedTimelineComponent.js","assets/img/MarbleTexture.jpg","assets/img/GoldTexture.png","themes/default.js","scripts/createRegionDict.js","assets/other/joyrideSteps.js","App.js","scripts/saveScenario.js","scripts/nextNumInList.js","index.js"],"names":["transformDict","useStyles","makeStyles","theme","retractButton","position","width","height","backgroundColor","palette","background","light","borderBottomLeftRadius","borderBottomRightRadius","display","justifyContent","alignItems","textAlign","marginLeft","marginTop","visibility","RetractButton","props","classes","transform","direction","Icon","checked","UpIcon","DownIcon","className","onClick","style","top","left","size","menuContainer","zIndex","flexFlow","borderBottomStyle","borderRightStyle","borderColor","border","backgroundImage","main","WebkitBorderImage","borderImage","menuButton","fontSize","margin","padding","MenuComponent","React","useState","setDisplay","Slide","in","unmountOnExit","mountOnEnter","id","Button","window","location","reload","save","onDrop","acceptedFiles","file","onload","text","then","obj","JSON","parse","loadScenario","loadSave","getRootProps","getInputProps","openHelp","memo","JsxMarkerContent","ref","html","innerHTML","this","previousHtml","onRender","onRef","bind","children","Component","JsxMarker","state","markerRef","createRef","setState","marker","icon","divIcon","iconSize","Marker","draggable","eventHandlers","dragend","updatePosition","markerID","current","getLatLng","editable","removable","closeButton","autoClose","closeOnClick","saveContentCallback","content","updateContent","removalCallback","index","removeMarker","Fragment","onInsideRender","LassoComponent","eventHandler","event","indices","layers","forEach","layer","feature","properties","regionID","push","updateLassoSelecting","assignRegions","map","useMap","lasso","L","setOptions","intersect","enable","useEffect","addEventListener","disable","removeEventListener","mapProviders","name","attr","src","generateUniqueID","Math","floor","random","markerIcons","GiWarAxe","GiAxeSword","GiBloodySword","GiBroadsword","GiCrossedSwords","GiDervishSwords","GiAntiAircraftGun","GiFieldGun","GiSaberAndPistol","GiPistolGun","GiRevolver","GiWinchesterRifle","GiApc","GiHorseHead","GiCavalry","GiTankTread","GiTank","GiBattleTank","GiModernCity","GiLighthouse","GiHouse","GiRefinery","GiFamilyHouse","GiCastle","GiElvenCastle","GiSteamLocomotive","GiStoneTower","GiBarracks","GiBarracksTent","GiAqueduct","GiCargoShip","GiBattleship","GiShipBow","GiShipWheel","GiSinagot","GiShoonerSailboat","GiEagleEmblem","GiWingedEmblem","GiHawkEmblem","GiSteelwingEmblem","GiSwordsEmblem","GiCondorEmblem","GiRadioactive","GiRadarSweep","GiSpikedDragonHead","GiRoundStar","GiSeaDragon","GiSeaSerpent","MapComponent","markerData","getMarkerData","geojsonRef","mapElement","onEachFeature","resetAllRegionStyle","clickRegion","highlightRegion","resetHighlightRegion","resetSpecifiedRegionStyle","addMarker","updateMarkerPosition","updateMarkerData","updateMarkerContent","currentData","cloneDeep","lat","lng","iconIndex","color","callback","lassoSelecting","processRegionHoveredOn","processRegionHoveredOut","getRegionColorByIndex","themeDict","polyStrokeColor","weight","polyStrokeWeight","fillColor","polyFillColorDefault","fillOpacity","polyFillOpacityColored","polyFillOpacityDefault","polyFillOpacityHovered","setStyle","hightlightStyle","picking","setColorBarColor","same","assignSameColor","Object","values","_layers","markers","entries","markerSize","markerIcon","MapContainer","center","zoom","scrollWheelZoom","preferCanvas","zoomSnap","wheelPxPerZoomLevel","doubleClickZoom","zoomControl","attributionControl","worldCopyJump","whenCreated","mapContainer","LayersControl","entry","BaseLayer","TileLayer","attribution","url","Overlay","GeoJSON","data","baseMap","smoothFactor","FeatureGroup","activeEntry","AttributionControl","PureComponent","withStyles","filter","defaultColors","ColorBarComponent","colorLabel","getColorLabel","updateLegendLabel","colorHex","colorBarContainer","colorPickerContainer","currentColor","sliderPickerContainer","onChange","hex","compactPickerContainer","compactPicker","colors","colorInfo","Tooltip","title","colorInfoHelp","colorInfoTextDescriptor","Typography","noWrap","variant","item","colorInfoTextLabel","InputBase","colorInfoLabelEntry","inputProps","value","fullWidth","e","target","disabled","borderStyle","flexGrow","rgbInput","primary","marginRight","toolbarContainer","right","toolbarButton","minWidth","ToolbarComponent","lassoButtonText","lassoButtonColor","eraserButtonText","erasing","eraserButtonColor","sameButtonText","sameButtonColor","pickingButtonText","pickingButtonColor","updatePicking","updateErasing","updateSame","legendContainer","legendEntry","legendEntryColor","legendEntryLabel","legendEntryNum","legendGrid","totalLabel","displayNumSwitch","displayNumSwitchContainer","LegendEntry","label","displayNum","num","LegendPluginDict","component","setDisplayNum","keys","app","pluginData","colorData","FormControlLabel","control","Switch","labelPlacement","features","length","Grid","container","justify","wrap","initState","scenarioData","i","retval","help","functions","onAssignRegions","removedColors","addedColor","currentLegendData","updatePluginData","onAddEntry","newLegendEntry","splice","onDeleteEntry","regionInfoContainer","paddingLeft","regionInfoColor","regionInfoLabel","paddingTop","paddingBottom","RegionInfoPluginDict","themeDictDefault","other","onProcessRegionHoveredOn","regionDict","newRegionInfoData","createScenarioEntry","date","csscolors","altHistEditorLoaderContainer","paper","loaderDropzone","default","loader","currentSaveVersion","version","detectSaveVersion","processSave","one_zero_to_one_one","one_one_to_one_two","customMap","customMapGeojson","order","entryDict","AltHistEditorLoaderPluginDict","mapType","convertedObj","regionDictDefault","mapData","colorStringDict","colorEntry","plugins","legendData","console","log","scenarios","comScenarios","scenarioContainer","scenarioSelect","ScenarioPluginDict","selectedScenario","setSelectedScenario","Select","ListSubheader","key","MenuItem","customGeoJSONLoaderContainer","CustomGeoJSONLoaderPluginDict","resetAppBasedOnBasemap","mapKey","loadGeoJSON","themeContainer","themeInput","custTheme","custThemeType","typeConvFunc","String","Number","fieldLabels","ThemePluginDict","setThemeDict","fields","includes","TextField","type","newTheme","IconButton","mapRef","markerContainer","iconSelect","iconDisplay","iconColorInput","iconList","iconListEntry","markerHelp","IconSelector","anchorEl","setAnchorEl","handleClick","currentTarget","open","Boolean","undefined","iconChoices","MarkerIcon","updateIconIndex","Popper","disablePortal","RegionInfoPlugin","LegendPlugin","setColor","setIconIndex","align","Input","getBounds","getCenter","onUpdateActiveEntry","newIndex","currentMarkerData","newMarkerEntry","ScenarioPlugin","ThemePlugin","AltHistEditorLoaderPlugin","CustomGeoJSONLoaderPlugin","pluginMenuContainer","bottom","minHeight","borderTopStyle","borderLeftStyle","accordionContainer","paddingRight","accordionSummary","accordionDetails","accordionHelp","accordionItemContainer","borderRadius","PluginMenuComponent","accordionItems","Plugin","Accordion","defaultExpanded","square","AccordionSummary","expandIcon","IconButtonProps","AccordionDetails","addIconButtonContainer","addIconButton","secondary","TimelineAddButton","timelineMarkerSpacing","addEntry","stopPropagation","timelineMarker","entryButton","markerLabel","textOverflow","overflow","whiteSpace","TimelineMarker","selected","timelineMarkerLabelWidth","updateActiveEntry","timelineBarContainer","timelineLine","timelineBarContentContainer","timelineBarMarkerContainer","TimelineBarComponent","setSize","useLayoutEffect","updateSize","innerWidth","innerHeight","useWindowSize","lineLength","max","eventContainer","eventBar","eventButtonHolder","eventContent","resize","eventButton","dateInput","TimelineEventComponent","updateEventDate","clearEntry","deleteEntry","oneEntryLeft","updateEvent","multiline","playToolbarContainer","playToolbarButton","PlayToolbarComponent","updatePlaying","playing","pausePlaying","playTimeline","stopPlaying","changePlaySpeed","playSpeed","addIconButtonContainerCondensedTimeline","addIconButtonCondensedTimeline","CondensedTimelineAddButton","deleteIconButtonContainerCondensedTimeline","deleteIconButtonCondensedTimeline","CondensedTimelineDeleteButton","condensedTimelineContainer","tableHeading","overflowWrap","hyphens","tableCell","dateColumn","eventColumn","notCurrentTableEntry","opacity","currentTableEntry","tableRowFocusColor","tableEntry","tableEnd","CondensedTimelineComponent","TableContainer","Paper","Table","aria-label","TableHead","TableRow","TableCell","TableBody","hover","material","dark","GoldTexture","MarbleTexture","createRegionDict","geoJson","region","steps","href","placement","ReactGA","initialize","pageview","pathname","search","createMuiTheme","App","mapAdmin","scenarioDataDefault","helpOn","colorBarRef","getColor","updateMultiPluginData","runPluginFunc","handleJoyrideCallback","initUndefinedPluginData","refreshColorBarInfo","args","val","newState","dataDict","currentColorData","newRegionDict","newColorEntry","document","getElementById","scrollIntoView","block","previousColor","blob","Blob","stringify","saveAs","saveScenario","currentPluginData","saveData","EVENTS","TOUR_END","colorID","currentEntryRegionDict","a","newEntry","Promise","r","setTimeout","newSpeed","number","array","numberIndex","indexOf","nextNumInList","ThemeProvider","continuous","disableOverlayClose","disableCloseOnEsc","showProgress","showSkipButton","run","styles","buttonClose","buttonSkip","ReactDOM","render"],"mappings":"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","file":"static/js/main.65b3c317.chunk.js","sourcesContent":["// Import React\r\nimport React from \"react\";\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport UpIcon from '@material-ui/icons/KeyboardArrowUp';\r\nimport DownIcon from '@material-ui/icons/KeyboardArrowDown';\r\n\r\nconst transformDict = {\r\n    \"up\": \"rotate(0deg)\",\r\n    \"down\": \"rotate(180deg)\",\r\n    \"right\": \"rotate(90deg)\",\r\n    \"left\": \"rotate(270deg)\",\r\n}\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    retractButton: {\r\n        position: \"absolute\",\r\n        width: 100,\r\n        height: 10,\r\n        backgroundColor: theme.palette.background.light,\r\n        borderBottomLeftRadius: 10,\r\n        borderBottomRightRadius: 10,\r\n        display: \"flex\",\r\n        justifyContent: \"center\",\r\n        alignItems: \"center\",\r\n        textAlign: \"center\",\r\n        marginLeft: -50,\r\n        marginTop: -5,\r\n        visibility: \"visible\", // ensures even with say transformations where visibility is hidden after transforming, that the button is still visible\r\n    }\r\n}));\r\n\r\nfunction RetractButton(props) {\r\n    const classes = useStyles();\r\n    const transform = transformDict[props.direction];\r\n    const Icon = props.checked ? UpIcon : DownIcon;\r\n    return (\r\n        <div\r\n            className={classes.retractButton}\r\n            onClick={props.onClick}\r\n            style={{\r\n                transform: \"scale(0.6)\" + transform,\r\n                top: props.top,\r\n                left: props.left,\r\n            }}\r\n        >\r\n            <Icon size=\"small\"/>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default RetractButton;","import React from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Button from '@material-ui/core/Button';\r\nimport loadScenario from '../scripts/loadScenario.js';\r\nimport Dropzone from 'react-dropzone';\r\nimport Slide from '@material-ui/core/Slide';\r\n\r\n// Import retract button custom component\r\nimport RetractButton from './RetractButton.js';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    menuContainer: {\r\n        position: \"absolute\",\r\n        top: 0,\r\n        left: 0,\r\n        height: 25,\r\n        width: 255,\r\n        zIndex: 1,\r\n        display: \"flex\",\r\n        flexFlow: \"row\",\r\n        justifyContent: \"flex-start\",\r\n        borderBottomStyle: \"ridge\",\r\n        borderRightStyle: \"ridge\",\r\n        borderColor: theme.palette.border,\r\n        backgroundImage: theme.palette.backgroundImage.main,\r\n        WebkitBorderImage: theme.palette.borderImage\r\n    },\r\n    menuButton: {\r\n        fontSize: 12,\r\n        margin: 0,\r\n        padding: 0,\r\n        height: \"100%\",\r\n    }\r\n}));\r\n\r\nfunction MenuComponent(props) {\r\n    const classes = useStyles();\r\n    const [display, setDisplay] = React.useState(true);\r\n    return (\r\n        <Slide direction=\"down\" in={display} unmountOnExit={false} mountOnEnter={false}>\r\n            <div className={classes.menuContainer} id=\"menu\">\r\n                <Button size=\"small\" className={classes.menuButton} onClick={() => window.location.reload()}>New</Button>\r\n                <Button size=\"small\" className={classes.menuButton} onClick={props.save}>Save</Button>\r\n                <Dropzone\r\n                    onDrop={acceptedFiles => {\r\n                        loadScenario(acceptedFiles[0], props.loadSave);\r\n                    }}\r\n                >\r\n                    {/*acceptedFiles[0] as we only care about a single file TODO: make some restriction to filetype (.json) to upload and number of files to upload (1 only)*/}\r\n                    {/*TODO: Here we used a drop zone, this might be an overkill to be honest as I only need a load button, so if performance drops too much or too much bandwidth taken, try to simplify this*/}\r\n                    {({ getRootProps, getInputProps }) => (\r\n                        <div {...getRootProps()}>\r\n                            <input {...getInputProps()} />\r\n                            <Button size=\"small\" className={classes.menuButton}>Load</Button>\r\n                            {/*This is a dummy button for visuals only, the uploading functionality is contained in the Dropzone and the input element*/}\r\n                        </div>\r\n                    )}\r\n                </Dropzone>\r\n                <Button size=\"small\" className={classes.menuButton} onClick={props.openHelp}>Help</Button>\r\n                <RetractButton direction=\"up\" top={31} left={\"50%\"} checked={display} onClick={() => setDisplay(!display)} />\r\n            </div>\r\n        </Slide>\r\n    );\r\n}\r\n\r\nexport default React.memo(MenuComponent);","// Expects a single file object, one that is compatible with JSON.stringify after processing\r\n// Returns the JSON object\r\nexport default function loadScenario(file, onload=null) {\r\n    file.text().then(text => {\r\n        const obj = JSON.parse(text);\r\n        if (onload) {\r\n            onload(obj);\r\n        }\r\n    });\r\n}","import React from 'react';\r\nimport { divIcon } from \"leaflet\";\r\nimport PropTypes from 'prop-types';\r\nimport { Marker } from \"react-leaflet\";\r\nimport Popup from 'react-leaflet-editable-popup';\r\nimport './JsxMarker.css';\r\n\r\n// Component that gives a \r\nclass JsxMarkerContent extends React.Component {\r\n\r\n    onRef(ref) {\r\n\r\n        if (ref) {\r\n            const html = ref.innerHTML;\r\n            if (html !== this.previousHtml) {\r\n                this.props.onRender(html);\r\n                this.previousHtml = html;\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"jsx-marker\" style={{ display: 'none' }} ref={this.onRef.bind(this)}>\r\n                {this.props.children}\r\n            </div>\r\n        );\r\n    }\r\n\r\n}\r\n\r\nclass JsxMarker extends React.Component {\r\n\r\n    static propTypes = {\r\n        position: PropTypes.object,\r\n        className: PropTypes.string\r\n    };\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            html: null\r\n        };\r\n\r\n        this.markerRef = React.createRef(null);\r\n    }\r\n\r\n    onInsideRender(html) {\r\n\r\n        // Set it\r\n        this.setState({ html });\r\n    }\r\n\r\n    render() {\r\n\r\n        const { html } = this.state;\r\n        let marker = false;\r\n        if (html) {\r\n\r\n            // Create divIcon\r\n            const icon = divIcon({\r\n                className: this.props.className,\r\n                html,\r\n                iconSize: [this.props.size, this.props.size],\r\n            });\r\n            marker = <Marker\r\n                draggable\r\n                position={this.props.position}\r\n                ref={this.markerRef}\r\n                icon={icon} {...this.props}\r\n                eventHandlers={{\r\n                    dragend: () => {\r\n                        this.props.updatePosition(this.props.markerID, this.markerRef.current.getLatLng());\r\n                    }\r\n                }}\r\n            >\r\n                <Popup\r\n                    editable\r\n                    removable\r\n                    closeButton={false}\r\n                    autoClose={false}\r\n                    closeOnClick={false}\r\n                    saveContentCallback={content => this.props.updateContent(this.props.markerID, content)}\r\n                    removalCallback={index => this.props.removeMarker(this.props.markerID)}\r\n                >\r\n                    {this.props.content}\r\n                </Popup>\r\n            </Marker>\r\n\r\n        }\r\n\r\n\r\n        return (<React.Fragment>\r\n\r\n            <JsxMarkerContent onRender={html => this.onInsideRender(html)}>\r\n                {this.props.children}\r\n            </JsxMarkerContent>\r\n\r\n            {marker}\r\n\r\n        </React.Fragment>);\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default JsxMarker;","import React from \"react\";\r\nimport L from \"leaflet\";\r\nimport { useMap } from \"react-leaflet\";\r\nimport \"leaflet-lasso\";\r\n\r\nexport default function LassoComponent(props) {\r\n    // Event handler for when lasso selection is complete\r\n    const eventHandler = event => {\r\n        let indices = [];\r\n        if (event) { // Series of if statements to only record in indices the valid selected regions TODO: this seems a bit dodgy, problem is this is like one of those silently neglect mistakes types of code\r\n            if (event.layers) {\r\n                event.layers.forEach(layer => {\r\n                    if (layer) {\r\n                        if (layer.feature) {\r\n                            if (layer.feature.properties) {\r\n                                if (layer.feature.properties.regionID) {\r\n                                    indices.push(layer.feature.properties.regionID);\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                });       \r\n            }\r\n        }\r\n        props.updateLassoSelecting(false, () => {props.assignRegions(indices);})\r\n    };\r\n\r\n    // Setup lasso\r\n    const map = useMap();\r\n    const lasso = L.lasso(map);\r\n    lasso.setOptions({ intersect: true });\r\n    lasso.enable();\r\n\r\n    React.useEffect(() => {\r\n        // Execute region coloring upon lasso selection completion\r\n        map.addEventListener('lasso.finished', eventHandler);\r\n\r\n        return (() => { // What to do on unmounting the LassoComponent\r\n            lasso.disable(); // FIXME: bug: disabling via clicking cancel button, i.e. in the case of disabling via using the cancel button, appears to lead to the drawing of selection persisting, though that selection has no coloring effect\r\n            map.removeEventListener('lasso.finished', eventHandler); // Remove event handler to avoid creating multiple handlers\r\n        });\r\n    }, [map, lasso]);\r\n\r\n    return null;\r\n}\r\n","// Add leaflet providers here\r\nconst mapProviders = [\r\n    {\r\n        name: \"Esri.WorldImagery\",\r\n        attr: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community',\r\n        src: 'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}'\r\n    },\r\n    {\r\n        name: \"Empty Map\",\r\n        attr: '',\r\n        src: ''\r\n    },\r\n    {\r\n        name: \"OpenTopoMap\",\r\n        attr: 'Map data: &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors, <a href=\"http://viewfinderpanoramas.org\">SRTM</a> | Map style: &copy; <a href=\"https://opentopomap.org\">OpenTopoMap</a> (<a href=\"https://creativecommons.org/licenses/by-sa/3.0/\">CC-BY-SA</a>)',\r\n        src: 'https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png'\r\n    },\r\n    {\r\n        name: \"OpenStreetMap.Mapnik\",\r\n        attr: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\r\n        src: 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'\r\n    },\r\n    {\r\n        name: \"Stamen.TerrainBackground\",\r\n        attr: 'Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>, <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a> &mdash; Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\r\n        src: 'https://stamen-tiles-{s}.a.ssl.fastly.net/terrain-background/{z}/{x}/{y}{r}.png'\r\n    },\r\n    {\r\n        name: \"Stamen.Watercolor\",\r\n        attr: 'Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>, <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a> &mdash; Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\r\n        src: 'https://stamen-tiles-{s}.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png'\r\n    },\r\n    {\r\n        name: \"Stamen.TonerBackground\",\r\n        attr: 'Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>, <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a> &mdash; Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\r\n        src: 'https://stamen-tiles-{s}.a.ssl.fastly.net/toner-background/{z}/{x}/{y}{r}.png'\r\n    },\r\n]\r\n\r\nexport default mapProviders;","function generateUniqueID(obj) {\r\n    let id = Math.floor(Math.random() * 10000);\r\n    if (id in obj) {\r\n        return generateUniqueID(obj);\r\n    } else {\r\n        return id;\r\n    }\r\n}\r\n\r\nexport default generateUniqueID;","import {\r\n    GiWarAxe, GiAxeSword, GiBloodySword, GiBroadsword, GiCrossedSwords, GiDervishSwords,\r\n    GiAntiAircraftGun, GiFieldGun, GiSaberAndPistol, GiPistolGun, GiRevolver, GiWinchesterRifle,\r\n    GiApc, GiHorseHead, GiCavalry, GiTankTread, GiTank, GiBattleTank,\r\n    GiModernCity, GiLighthouse, GiHouse, GiRefinery, GiFamilyHouse, GiCastle,\r\n    GiElvenCastle, GiSteamLocomotive, GiStoneTower, GiBarracks, GiBarracksTent, GiAqueduct,\r\n    GiCargoShip, GiBattleship, GiShipBow, GiShipWheel, GiSinagot, GiShoonerSailboat,\r\n    GiEagleEmblem, GiWingedEmblem, GiHawkEmblem, GiSteelwingEmblem, GiSwordsEmblem, GiCondorEmblem,\r\n    GiRadioactive, GiRadarSweep, GiSpikedDragonHead, GiRoundStar, GiSeaDragon, GiSeaSerpent\r\n} from 'react-icons/gi';\r\n\r\nconst markerIcons = [\r\n    GiWarAxe, GiAxeSword, GiBloodySword, GiBroadsword, GiCrossedSwords, GiDervishSwords,\r\n    GiAntiAircraftGun, GiFieldGun, GiSaberAndPistol, GiPistolGun, GiRevolver, GiWinchesterRifle,\r\n    GiApc, GiHorseHead, GiCavalry, GiTankTread, GiTank, GiBattleTank,\r\n    GiModernCity, GiLighthouse, GiHouse, GiRefinery, GiFamilyHouse, GiCastle,\r\n    GiElvenCastle, GiSteamLocomotive, GiStoneTower, GiBarracks, GiBarracksTent, GiAqueduct,\r\n    GiCargoShip, GiBattleship, GiShipBow, GiShipWheel, GiSinagot, GiShoonerSailboat,\r\n    GiEagleEmblem, GiWingedEmblem, GiHawkEmblem, GiSteelwingEmblem, GiSwordsEmblem, GiCondorEmblem,\r\n    GiRadioactive, GiRadarSweep, GiSpikedDragonHead, GiRoundStar, GiSeaDragon, GiSeaSerpent\r\n]\r\n\r\nexport default markerIcons;","// Import React\r\nimport React from \"react\";\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// Import leaflet and related libraries\r\nimport { MapContainer, GeoJSON, TileLayer, AttributionControl, LayersControl, FeatureGroup, useMap } from 'react-leaflet';\r\nimport \"leaflet/dist/leaflet.css\";\r\nimport JsxMarker from \"./JsxMarker.js\";\r\n\r\n// Import relevant custom components for plugins\r\nimport LassoComponent from \"./LassoComponent.js\";\r\n\r\n// Import mapProviders settings\r\nimport mapProviders from '../settings/mapProviders.js';\r\n\r\n// Additional imports\r\nimport cloneDeep from \"clone-deep\";\r\nimport generateUniqueID from \"../scripts/generateUniqueID.js\";\r\nimport markerIcons from \"../assets/other/markerIcons.js\";\r\n\r\nconst useStyles = theme => ({\r\n    mapContainer: {\r\n        position: \"absolute\",\r\n        top: 0,\r\n        left: 0,\r\n        width: \"100vw\",\r\n        height: \"calc(100vh - 45px)\", // the -50px is to ensure that the map's bottom meets the timeline bar, hence if timeline bar height is adjusted, adjust map height here accordingly\r\n        zIndex: 0,\r\n        filter: \"brightness(1) contrast(100%)\",\r\n    },\r\n    markerIcon: {\r\n        width: \"100%\",\r\n        height: \"100%\",\r\n    }\r\n});\r\nclass MapComponent extends React.PureComponent {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            markerData: props.getMarkerData(),\r\n        }\r\n\r\n        // Add references to useful entites\r\n        this.geojsonRef = React.createRef(null);\r\n        this.mapElement = null;\r\n\r\n        // Binding methods\r\n        this.onEachFeature = this.onEachFeature.bind(this);\r\n        this.style = this.style.bind(this);\r\n        this.resetAllRegionStyle = this.resetAllRegionStyle.bind(this);\r\n        this.clickRegion = this.clickRegion.bind(this);\r\n        this.highlightRegion = this.highlightRegion.bind(this);\r\n        this.resetHighlightRegion = this.resetHighlightRegion.bind(this);\r\n        this.resetSpecifiedRegionStyle = this.resetSpecifiedRegionStyle.bind(this);\r\n        this.addMarker = this.addMarker.bind(this);\r\n        this.updateMarkerPosition = this.updateMarkerPosition.bind(this);\r\n        this.updateMarkerData = this.updateMarkerData.bind(this);\r\n        this.updateMarkerContent = this.updateMarkerContent.bind(this);\r\n        this.removeMarker = this.removeMarker.bind(this);\r\n    }\r\n\r\n    removeMarker(markerID) {\r\n        let currentData = cloneDeep(this.state.markerData);\r\n\r\n        delete currentData[markerID];\r\n\r\n        this.setState({ markerData: currentData }, () => {\r\n            this.props.updateMarkerData(this.state.markerData);\r\n        });        \r\n    }\r\n\r\n    updateMarkerPosition(markerID, position) {\r\n        let currentData = cloneDeep(this.state.markerData);\r\n\r\n        currentData[markerID].lat = position.lat;\r\n        currentData[markerID].lng = position.lng;\r\n\r\n        this.setState({ markerData: currentData }, () => {\r\n            this.props.updateMarkerData(this.state.markerData);\r\n        });\r\n    }\r\n\r\n    updateMarkerContent(markerID, content) {\r\n        let currentData = cloneDeep(this.state.markerData);\r\n\r\n        currentData[markerID].content = content;\r\n\r\n        this.setState({ markerData: currentData }, () => {\r\n            this.props.updateMarkerData(this.state.markerData);\r\n        });        \r\n    }\r\n\r\n    addMarker(iconIndex, color, lat = 50, lng = 0, content = \"\") {\r\n        let currentData = cloneDeep(this.state.markerData);\r\n\r\n        // Generate a unique ID\r\n        const id = generateUniqueID(currentData);\r\n\r\n        currentData[id] = {\r\n            iconIndex: iconIndex,\r\n            color: color,\r\n            lat: lat,\r\n            lng: lng,\r\n            content: content\r\n        };\r\n        this.setState({ markerData: currentData }, () => {\r\n            this.props.updateMarkerData(this.state.markerData);\r\n        });\r\n    }\r\n\r\n    // Updates marker data to correspond to the active entry\r\n    updateMarkerData(callback=null) {\r\n        this.setState({ markerData: this.props.getMarkerData() }, () => {\r\n            if (callback) {\r\n                callback();\r\n            }\r\n        });\r\n    }\r\n\r\n    onEachFeature(feature, layer) {\r\n        layer.addEventListener(\"click\", () => {\r\n            this.clickRegion(feature, layer);\r\n        });\r\n        layer.addEventListener(\"mouseover\", () => {\r\n            if (!this.props.lassoSelecting) {\r\n                // Ensures lasso selection is not interfered by mouse events\r\n                this.highlightRegion(feature, layer);\r\n                this.props.processRegionHoveredOn(layer);\r\n            }\r\n        });\r\n        layer.addEventListener(\"mouseout\", () => {\r\n            if (!this.props.lassoSelecting) {\r\n                // Ensures lasso selection is not interfered by mouse events\r\n                this.resetHighlightRegion(feature, layer);\r\n                this.props.processRegionHoveredOut(layer);\r\n            }\r\n        });\r\n    }\r\n\r\n    style(feature, layer) {\r\n        const color = this.props.getRegionColorByIndex(feature.properties.regionID);\r\n        return {\r\n            color: this.props.themeDict.polyStrokeColor,\r\n            weight: this.props.themeDict.polyStrokeWeight,\r\n            fillColor: color ? color : this.props.themeDict.polyFillColorDefault,\r\n            fillOpacity: color ? this.props.themeDict.polyFillOpacityColored : this.props.themeDict.polyFillOpacityDefault,\r\n        };\r\n    }\r\n\r\n\r\n    hightlightStyle(feature, layer) {\r\n        return {\r\n            fillOpacity: this.props.themeDict.polyFillOpacityHovered\r\n        };\r\n    }\r\n\r\n    highlightRegion(feature, layer) {\r\n        layer.setStyle(this.hightlightStyle(feature, layer));\r\n    }\r\n\r\n    resetHighlightRegion(feature, layer) {\r\n        layer.setStyle(this.style(feature, layer));\r\n    }\r\n\r\n    clickRegion(feature, layer) {\r\n        if (this.props.picking) { // Case if click is when picking is true\r\n            const color = this.props.getRegionColorByIndex(feature.properties.regionID); // Get color of region clicked on\r\n            if (color) {\r\n                // if region has a color, else just do nothing\r\n                this.props.setColorBarColor(color);\r\n            }\r\n        } else if (this.props.same) { // Case if click is when erase same button is activated\r\n            const color = this.props.getRegionColorByIndex(feature.properties.regionID); // Get color of region clicked on, this will serve as our ID for region\r\n            this.props.assignSameColor(color);\r\n        } else {\r\n            // Picking color tool not selected and same color region modification not selected, hence color region as usual (either color or erase)\r\n            this.props.assignRegions([feature.properties.regionID]);\r\n            layer.setStyle(this.style(feature, layer)); // TODO: such setting would not highlight the region though, which might be a problem\r\n        }\r\n    }\r\n\r\n    // Resets styles of all regions to match those of the regionDict data\r\n    resetAllRegionStyle() {\r\n        Object.values(this.geojsonRef.current._layers).forEach(layer => {\r\n            layer.setStyle(this.style(layer.feature, layer));\r\n        });\r\n    }\r\n\r\n    // Resets style of specified regions to match those of regionDict data\r\n    resetSpecifiedRegionStyle(indices) {\r\n        let layers = Object.values(this.geojsonRef.current._layers);\r\n        indices.forEach(index => {\r\n            let layer = layers[index];\r\n            let feature = layer.feature;\r\n            layers[index].setStyle(this.style(feature, layer));\r\n        });\r\n    }\r\n\r\n    render() {\r\n        const { classes } = this.props;\r\n\r\n        const markers = Object.entries(this.state.markerData).map(marker => {\r\n            const Icon = markerIcons[marker[1].iconIndex];\r\n            return (\r\n                <JsxMarker\r\n                    key={marker[0]}\r\n                    markerID={marker[0]}\r\n                    position={{\r\n                        lat: marker[1].lat,\r\n                        lng: marker[1].lng\r\n                    }}\r\n                    size={this.props.themeDict.markerSize}\r\n                    content={marker[1].content}\r\n                    updatePosition={this.updateMarkerPosition}\r\n                    updateContent={this.updateMarkerContent}\r\n                    removeMarker={this.removeMarker}\r\n                >\r\n                    <Icon className={classes.markerIcon} style={{ color: marker[1].color }} />\r\n                </JsxMarker>\r\n            );\r\n        });\r\n\r\n        return (\r\n            <MapContainer\r\n                center={[30, 0]}\r\n                zoom={3}\r\n                scrollWheelZoom\r\n                preferCanvas\r\n                zoomSnap={0}\r\n                wheelPxPerZoomLevel={120}\r\n                doubleClickZoom={false}\r\n                zoomControl={false}\r\n                attributionControl={false}\r\n                worldCopyJump\r\n                id=\"map\"\r\n                whenCreated={map => {this.mapElement = map;}}\r\n                className={classes.mapContainer}\r\n            >\r\n                <LayersControl position=\"topright\">\r\n                    {mapProviders.map((entry, index) => <LayersControl.BaseLayer key={entry.name} checked={index === 0} name={entry.name}>\r\n                        <TileLayer\r\n                            attribution={entry.attr}\r\n                            url={entry.src}\r\n                        ></TileLayer>\r\n                    </LayersControl.BaseLayer>)}\r\n                    <LayersControl.Overlay checked name=\"Regions\">\r\n                        <GeoJSON\r\n                            data={this.props.baseMap}\r\n                            style={this.style}\r\n                            onEachFeature={this.onEachFeature}\r\n                            smoothFactor={0}\r\n                            ref={this.geojsonRef}\r\n                        ></GeoJSON>\r\n                    </LayersControl.Overlay>\r\n                    <LayersControl.Overlay checked name=\"Markers\">\r\n                        <FeatureGroup key={this.props.activeEntry}>\r\n                            {markers}\r\n                        </FeatureGroup>\r\n                    </LayersControl.Overlay>\r\n                </LayersControl>\r\n                <AttributionControl position=\"bottomright\" />\r\n                {this.props.lassoSelecting && <LassoComponent updateLassoSelecting={this.props.updateLassoSelecting} assignRegions={this.props.assignRegions} />}\r\n            </MapContainer>\r\n        );\r\n    }\r\n}\r\n\r\nexport default withStyles(useStyles)(MapComponent);","const defaultColors = [\r\n    '#4D4D4D', '#999999', '#FFFFFF', '#F44E3B', '#FE9200', '#FCDC00',\r\n    '#DBDF00', '#A4DD00', '#68CCCA', '#73D8FF', '#AEA1FF', '#FDA1FF',\r\n    '#333333', '#808080', '#cccccc', '#D33115', '#E27300', '#FCC400',\r\n    '#B0BC00', '#68BC00', '#16A5A5', '#009CE0', '#7B64FF', '#FA28FF',\r\n]\r\n\r\nexport default defaultColors;","// Import React\r\nimport React from \"react\";\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport Slide from '@material-ui/core/Slide';\r\nimport HelpOutlineIcon from '@material-ui/icons/HelpOutline';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\n\r\n// Import react stuff for color info\r\nimport Typography from '@material-ui/core/Typography';\r\nimport InputBase from '@material-ui/core/InputBase';\r\n\r\n// Import retract button custom component\r\nimport RetractButton from './RetractButton.js';\r\n\r\n// Import color picker\r\nimport { SliderPicker, CompactPicker } from 'react-color';\r\nimport defaultColors from \"../assets/other/defaultColors\";\r\n\r\nconst useStyles = theme => ({\r\n    colorBarContainer: {\r\n        position: \"absolute\",\r\n        top: 0,\r\n        left: \"50%\",\r\n        width: 360,\r\n        height: 80,\r\n        zIndex: 2,\r\n        display: \"flex\",\r\n        justifyContent: \"space-evenly\",\r\n        flexFlow: \"column\",\r\n        alignItems: \"center\",\r\n        marginLeft: -185,\r\n        marginTop: 30,\r\n        padding: 5,\r\n        borderStyle: \"ridge\",\r\n        borderColor: theme.palette.border,\r\n        backgroundImage: theme.palette.backgroundImage.main,\r\n        WebkitBorderImage: theme.palette.borderImage,\r\n    },\r\n    colorPickerContainer: {\r\n        display: \"flex\",\r\n        justifyContent: \"space-evenly\",\r\n        flexFlow: \"row\",\r\n        alignItems: \"center\",\r\n        width: \"100%\",\r\n        flexGrow: 1,\r\n    },\r\n    sliderPickerContainer: {\r\n        display: \"flex\",\r\n        justifyContent: \"center\",\r\n        flexFlow: \"column\",\r\n        alignItems: \"stretch\",\r\n        width: 120\r\n    },\r\n    compactPickerContainer: {\r\n        display: \"flex\",\r\n        justifyContent: \"center\",\r\n        flexFlow: \"column\",\r\n        alignItems: \"stretch\",\r\n        width: 245,\r\n        margin: -22,\r\n        transform: \"scale(0.8)\",\r\n    },\r\n    rgbInput: {\r\n        display: \"flex\",\r\n        justifyContent: \"center\",\r\n        flexFlow: \"row\",\r\n    },\r\n    currentColor: {\r\n        height: 20,\r\n        width: 20,\r\n        margin: 5\r\n    },\r\n    compactPicker: {\r\n        backgroundColor: theme.palette.background.light,\r\n    },\r\n    colorInfo: {\r\n        height: 20,\r\n        width: \"100%\",\r\n        display: \"flex\",\r\n        justifyContent: \"center\",\r\n        flexFlow: \"row\",\r\n        alignItems: \"center\",\r\n        color: theme.palette.text.primary,\r\n    },\r\n    colorInfoTextDescriptor: {\r\n        width: \"25%\",\r\n        display: \"flex\",\r\n        justifyContent: \"center\",\r\n        flexFlow: \"row\",\r\n        alignItems: \"center\",\r\n        marginRight: 10,\r\n    },\r\n    colorInfoTextLabel: {\r\n        width: \"50%\",\r\n        display: \"flex\",\r\n        justifyContent: \"center\",\r\n        flexFlow: \"row\",\r\n        alignItems: \"center\",\r\n    },\r\n    colorInfoLabelEntry: {\r\n        fontSize: 14,\r\n    },\r\n    colorInfoHelp: {\r\n        marginTop: 3,\r\n        marginRight: 10,\r\n    }\r\n});\r\n\r\nclass ColorBarComponent extends React.PureComponent {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            color: \"#bf4340\", // Default color, it is the color when slider in first row of color bar is set to leftmost position, and the centre one of the 5 colors in the second row of the color bar is chosen\r\n            display: true, // Default to showing the colorbar\r\n            colorLabel: props.getColorLabel(\"#bf4340\")\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const { classes, getColorLabel, updateLegendLabel } = this.props;\r\n        const colorHex = this.state.color;\r\n        return (\r\n            <Slide direction=\"down\" in={this.state.display} unmountOnExit={false} mountOnEnter={false}>\r\n                <div className={classes.colorBarContainer} id=\"colorbar\">\r\n                    <div className={classes.colorPickerContainer}>\r\n                        <div className={classes.currentColor} style={{ backgroundColor: colorHex }} />\r\n                        <div className={classes.sliderPickerContainer}>\r\n                            <SliderPicker color={colorHex} onChange={(color, event) => this.setState({ color: color.hex, colorLabel: getColorLabel(color.hex) })} />\r\n                        </div>\r\n                        <div className={classes.compactPickerContainer}>\r\n                            <CompactPicker className={classes.compactPicker} color={colorHex} colors={defaultColors} onChange={(color, event) => this.setState({ color: color.hex, colorLabel: getColorLabel(color.hex) })} />\r\n                        </div>\r\n                    </div>\r\n                    <div className={classes.colorInfo} id=\"colorinfo\">\r\n                        <Tooltip\r\n                            title={\"Legend label (if any) for selected color. Edit label by clicking (alternatively use legend panel in side menu)\"}\r\n                        >\r\n                            <div className={classes.colorInfoHelp}>\r\n                                <HelpOutlineIcon fontSize=\"small\"/>\r\n                            </div>\r\n                        </Tooltip>\r\n                        <div className={classes.colorInfoTextDescriptor}>\r\n                            <Typography noWrap variant=\"body2\" item=\"true\">{\"Legend label: \"}</Typography>\r\n                        </div>\r\n                        <div className={classes.colorInfoTextLabel}>\r\n                            <InputBase\r\n                                className={classes.colorInfoLabelEntry}\r\n                                inputProps={{style: { textAlign: \"center\"} }}\r\n                                value={this.state.colorLabel !== null ? this.state.colorLabel : \"Not on map\"}\r\n                                fullWidth\r\n                                onChange={e => updateLegendLabel(this.state.color, e.target.value)}\r\n                                disabled={this.state.colorLabel !== null ? false : true}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                    <RetractButton direction=\"up\" top={96} left={27} checked={this.state.display} onClick={() => this.setState({ display: !this.state.display })} />\r\n                </div>\r\n            </Slide>\r\n        );\r\n    }\r\n}\r\n\r\nexport default withStyles(useStyles)(ColorBarComponent);","// Import React\r\nimport React from \"react\";\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Slide from '@material-ui/core/Slide';\r\n\r\n// Import retract button custom component\r\nimport RetractButton from './RetractButton.js';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    toolbarContainer: {\r\n        position: \"absolute\",\r\n        top: 122,\r\n        right: \"50%\",\r\n        marginRight: -235 / 2,\r\n        height: 30,\r\n        width: 220,\r\n        zIndex: 1,\r\n        display: \"flex\",\r\n        flexFlow: \"row\",\r\n        justifyContent: \"flex-end\",\r\n        borderStyle: \"ridge\",\r\n        borderColor: theme.palette.border,\r\n        backgroundImage: theme.palette.backgroundImage.main,\r\n        WebkitBorderImage: theme.palette.borderImage\r\n    },\r\n    toolbarButton: {\r\n        fontSize: 12,\r\n        margin: 0,\r\n        padding: 0,\r\n        height: \"100%\",\r\n        minWidth: 55,\r\n    }\r\n}));\r\n\r\nfunction ToolbarComponent(props) {\r\n    const classes = useStyles();\r\n    const lassoButtonText = props.lassoSelecting ? \"Cancel\" : \"Lasso\"; // TODO: using switches might be better in these situations\r\n    const lassoButtonColor = props.lassoSelecting ? \"secondary\" : \"default\";\r\n    const eraserButtonText = props.erasing ? \"Cancel\" : \"Erase\";\r\n    const eraserButtonColor = props.erasing ? \"secondary\" : \"default\";\r\n    const sameButtonText = props.same ? \"Cancel\" : \"Same\";\r\n    const sameButtonColor = props.same ? \"secondary\" : \"default\";\r\n    const pickingButtonText = props.picking ? \"Cancel\" : \"Pick\";\r\n    const pickingButtonColor = props.picking ? \"secondary\" : \"default\";\r\n    const [display, setDisplay] = React.useState(true);\r\n    return (\r\n        <Slide direction=\"down\" in={display} unmountOnExit={false} mountOnEnter={false}>\r\n            <div className={classes.toolbarContainer} id=\"toolbar\">\r\n                <Button\r\n                    color={eraserButtonColor}\r\n                    className={classes.toolbarButton}\r\n                    onClick={() => {\r\n                        props.updatePicking(false, () => {\r\n                            props.updateErasing(!props.erasing);\r\n                        })\r\n                    }}\r\n                >\r\n                    {eraserButtonText}\r\n                </Button>\r\n                <Button\r\n                    color={sameButtonColor}\r\n                    className={classes.toolbarButton}\r\n                    onClick={() => {\r\n                        props.updateLassoSelecting(false, () => {\r\n                            props.updatePicking(false, () => {\r\n                                props.updateSame(!props.same);\r\n                            });\r\n                        });\r\n                    }}\r\n                >\r\n                    {sameButtonText}\r\n                </Button>\r\n                <Button\r\n                    color={lassoButtonColor}\r\n                    className={classes.toolbarButton}\r\n                    onClick={() => {\r\n                        props.updatePicking(false, () => {\r\n                            props.updateSame(false, () => {\r\n                                props.updateLassoSelecting(!props.lassoSelecting);\r\n                            });\r\n                        })\r\n                    }}\r\n                >\r\n                    {lassoButtonText}\r\n                </Button>\r\n                <Button\r\n                    color={pickingButtonColor}\r\n                    className={classes.toolbarButton}\r\n                    onClick={() => {\r\n                        props.updateLassoSelecting(false, () => {\r\n                            props.updateErasing(false, () => {\r\n                                props.updateSame(false, () => {\r\n                                    props.updatePicking(!props.picking);\r\n                                });\r\n                            });\r\n                        });\r\n                    }}\r\n                >\r\n                    {pickingButtonText}\r\n                </Button>\r\n                <RetractButton direction=\"up\" top={36} left={\"50%\"} checked={display} onClick={() => setDisplay(!display)} />\r\n            </div>\r\n        </Slide>\r\n    );\r\n}\r\n\r\nexport default React.memo(ToolbarComponent);","import React from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport Scrollbars from 'react-custom-scrollbars';\r\nimport cloneDeep from \"clone-deep\";\r\nimport InputBase from '@material-ui/core/InputBase';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Switch from '@material-ui/core/Switch';\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    legendContainer: {\r\n        height: 240,\r\n        width: \"100%\",\r\n        display: \"flex\",\r\n        flexFlow: \"column\",\r\n        justifyContent: \"space-evenly\"\r\n    },\r\n    legendEntry: {\r\n        display: \"flex\",\r\n        flexFlow: \"row\",\r\n        alignItems: \"center\",\r\n        justifyContent: \"flex-start\",\r\n    },\r\n    legendEntryColor: {\r\n        width: 12,\r\n        height: 12,\r\n        margin: 5,\r\n    },\r\n    legendEntryLabel: {\r\n        width: 80,\r\n        fontSize: 10,\r\n    },\r\n    legendEntryNum: {\r\n        marginLeft: 5,\r\n        marginRight: 5,\r\n        fontSize: 10,\r\n    },\r\n    legendGrid: {\r\n        height: 180,\r\n    },\r\n    totalLabel: {\r\n        display: \"flex\",\r\n        flexFlow: \"column\",\r\n        justifyContent: \"center\",\r\n        alignItems: \"center\",\r\n        transform: \"scale(0.9)\"\r\n    },\r\n    displayNumSwitch: {\r\n        transform: \"scale(0.6)\",\r\n    },\r\n    displayNumSwitchContainer: {\r\n        display: \"flex\",\r\n        flexFlow: \"column\",\r\n        justifyContent: \"center\",\r\n        alignItems: \"flex-end\",\r\n    }\r\n}));\r\n\r\nfunction LegendEntry(props) {\r\n    const classes = useStyles();\r\n    return (\r\n        <div className={classes.legendEntry}>\r\n            <div\r\n                style={{ backgroundColor: props.color }}\r\n                className={classes.legendEntryColor}\r\n                onClick={() => {\r\n                    props.setColorBarColor(props.color);\r\n                }}\r\n            />\r\n            <InputBase\r\n                className={classes.legendEntryLabel}\r\n                value={props.label}\r\n                onChange={props.onChange}\r\n            />\r\n            {props.displayNum && <Typography variant=\"caption\" className={classes.legendEntryNum}>{props.num}</Typography>}\r\n        </div>\r\n    )\r\n}\r\n\r\nfunction LegendComponent(props) {\r\n    const classes = useStyles();\r\n    const [displayNum, setDisplayNum] = React.useState(true);\r\n    const entries = Object.keys(props.app.state.pluginData[\"Legend\"][props.app.state.activeEntry]).map((color) =>\r\n        <LegendEntry\r\n            key={color}\r\n            color={color}\r\n            label={props.app.state.pluginData[\"Legend\"][props.app.state.activeEntry][color]}\r\n            num={props.app.state.colorData[props.app.state.activeEntry][color]}\r\n            displayNum={displayNum}\r\n            item\r\n            onChange={e => props.app.updateLegendLabel(color, e.target.value)}\r\n            setColorBarColor={props.app.setColorBarColor}\r\n        />);\r\n    return (\r\n        <div id=\"legend\" className={classes.legendContainer}>\r\n            <div className={classes.displayNumSwitchContainer}>\r\n                <FormControlLabel\r\n                    className={classes.displayNumSwitch}\r\n                    control={<Switch checked={displayNum} onChange={() => setDisplayNum(!displayNum)} />}\r\n                    label=\"Counts\"\r\n                    labelPlacement=\"start\"\r\n                />\r\n            </div>\r\n            <div className={classes.totalLabel}>\r\n                <Typography variant=\"caption\">Total Regions: {props.app.baseMap.features.length}</Typography>\r\n            </div>\r\n            <Scrollbars>\r\n                <Grid container direction=\"column\" justify=\"flex-start\" wrap=\"wrap\" className={classes.legendGrid}>\r\n                    {entries}\r\n                </Grid>\r\n            </Scrollbars>\r\n        </div>\r\n    );\r\n}\r\n\r\nconst initState = scenarioData => {\r\n    let retval = [];\r\n    let i;\r\n    for (i = 0; i < scenarioData.length; i++) {\r\n        retval.push({});\r\n    }\r\n    return retval;\r\n};\r\n\r\n// Adds color-label key value pair to pluginData entry for level of corresponding activeEntry if color was added for the first time, or delete the entry if no region has the color after the assigning\r\nfunction onAssignRegions(app, indices, color, removedColors, addedColor) {\r\n    let currentLegendData = cloneDeep(app.state.pluginData[\"Legend\"]);\r\n    if (addedColor) {\r\n        currentLegendData[app.state.activeEntry][color] = \"Label\";\r\n    }\r\n    removedColors.forEach(color => {\r\n        delete currentLegendData[app.state.activeEntry][color];\r\n    });\r\n    app.updatePluginData(\"Legend\", currentLegendData);\r\n}\r\n\r\nfunction onAddEntry(app, index) {\r\n    let currentLegendData = cloneDeep(app.state.pluginData[\"Legend\"]);\r\n    let newLegendEntry = null;\r\n    if (index > 0) { // Use new\r\n        newLegendEntry = cloneDeep(currentLegendData[index - 1]);\r\n    } else { // Use default\r\n        newLegendEntry = {};\r\n    }\r\n    currentLegendData.splice(index, 0, newLegendEntry);\r\n    return currentLegendData;\r\n}\r\n\r\nfunction onDeleteEntry(app, index) {\r\n    let currentLegendData = cloneDeep(app.state.pluginData[\"Legend\"]);\r\n    currentLegendData.splice(index, 1);\r\n    return currentLegendData;\r\n}\r\n\r\n// This dictionary contains the component, initial state value generation function for the plugin's entry in pluginData; this be based off the scenarioData state value\r\nconst LegendPluginDict = {\r\n    component: LegendComponent,\r\n    initState: initState,\r\n    help: \"Click to edit labels. Legend is scrollable. Numbers beside labels represent regions with the label. Clicking label color square picks the color.\",\r\n    functions: {\r\n        onAssignRegions: onAssignRegions,\r\n        onAddEntry: onAddEntry, // Expects index argument\r\n        onDeleteEntry: onDeleteEntry, // Expects index argument\r\n    }\r\n};\r\n\r\nexport default LegendPluginDict;","import { makeStyles } from '@material-ui/core/styles';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    regionInfoContainer: {\r\n        width: \"100%\",\r\n        paddingLeft: 10,\r\n        display: \"flex\",\r\n        flexFlow: \"column\",\r\n        alignItems: \"flex-start\",\r\n        justifyContent: \"flex-start\",\r\n        height: 80,\r\n    },\r\n    regionInfoColor: {\r\n        minWidth: 15,\r\n        height: 15,\r\n        marginLeft: 5,\r\n        marginRight: 10,\r\n        borderColor: theme.palette.text.primary,\r\n    },\r\n    regionInfoLabel: {\r\n        margin: 5,\r\n        paddingTop: 10,\r\n        paddingBottom: 10,\r\n    },\r\n}));\r\n\r\nfunction RegionInfoComponent(props) {\r\n    const classes = useStyles();\r\n    const data = props.app.state.pluginData[\"Region Info\"];\r\n    return (\r\n        <Grid id=\"region_info\" container direction=\"column\" justify=\"flex-start\" alignItems=\"flex-start\" className={classes.regionInfoContainer}>\r\n            <Grid container item direction=\"row\" justify=\"flex-start\" alignItems=\"center\">\r\n                <div\r\n                    item=\"true\"\r\n                    style={{ backgroundColor: data.color ? data.color : props.app.themeDictDefault.other.polyFillColorDefault }}\r\n                    className={classes.regionInfoColor}\r\n                />\r\n                <Typography noWrap variant=\"body2\" item=\"true\">{\"Name: \"}{data.name ? data.name : \"None\"}</Typography>\r\n            </Grid>\r\n            <Typography item=\"true\" variant=\"caption\" noWrap className={classes.regionInfoLabel}>{\"Label: \"}{data.label ? data.label : \"None\"}</Typography>\r\n        </Grid>\r\n    );\r\n}\r\n\r\nconst initState = scenarioData => {\r\n    return {\r\n        color: null,\r\n        name: null,\r\n        label: null,\r\n    };\r\n};\r\n\r\n// Sets region info to appropriate values based on hovered on layer\r\nfunction onProcessRegionHoveredOn(app, layer) {\r\n    const regionID = layer.feature.properties.regionID;\r\n    const color = app.state.scenarioData[app.state.activeEntry].regionDict[regionID].color;\r\n    const name = layer.feature.properties.name;\r\n    const label = app.state.pluginData[\"Legend\"][app.state.activeEntry][color];\r\n    let newRegionInfoData = {\r\n        color: color ? color : null,\r\n        name: name ? name : null,\r\n        label: label ? label : null,\r\n    };\r\n    app.updatePluginData(\"Region Info\", newRegionInfoData);\r\n}\r\n\r\nconst RegionInfoPluginDict = {\r\n    component: RegionInfoComponent,\r\n    initState: initState,\r\n    help: \"Displays name and label for the region hovered over.\",\r\n    functions: {\r\n        onProcessRegionHoveredOn: onProcessRegionHoveredOn,\r\n        // Although not having this causes the region info to linger on  after moving out of a region, it is faster and I feel that is worth is, nevertheless, try to find a solution that resolves the performance issue and ensures on moving out the region info is not set\r\n    }\r\n};\r\n\r\nexport default RegionInfoPluginDict;","// Import deep cloning function\r\nimport cloneDeep from 'clone-deep';\r\n\r\n// Create a scenario entry based on the inputted regionDict, date string, event description string\r\nexport default function createScenarioEntry(regionDict, date=\"\", event=\"\") {\r\n    return {\r\n        date: date,\r\n        event: event,\r\n        regionDict: cloneDeep(regionDict), // Necessary as it appears for such complicated objects simply setting equal to regionDict would not be pass by value enough, and so you end up with entries sharing state\r\n    }\r\n}","import React from 'react';\r\nimport Dropzone from 'react-dropzone';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport createScenarioEntry from '../scripts/createScenarioEntry.js';\r\nimport cloneDeep from 'clone-deep';\r\nimport csscolors from 'css-color-names';\r\n\r\n// Adding some additional colors that I customized in the alternate history app\r\ncsscolors[\"tyrian-purple\"] = \"#66023C\";\r\ncsscolors[\"wine\"] = \"#722f37\";\r\ncsscolors[\"persian-blue\"] = \"#1C39BB\";\r\ncsscolors[\"midnight-blue\"] = csscolors[\"midnightblue\"];\r\ncsscolors[\"sky-blue\"] = csscolors[\"skyblue\"];\r\ncsscolors[\"persian-green\"] = \"#00A693\";\r\ncsscolors[\"basil\"] = \"#579229\";\r\ncsscolors[\"fire\"] = \"#e25822\";\r\ncsscolors[\"ruby\"] = \"#9B111E\";\r\n\r\n// Setup styles\r\nconst useStyles = makeStyles((theme) => ({\r\n    altHistEditorLoaderContainer: {\r\n        height: 120,\r\n        backgroundColor: theme.palette.background.paper,\r\n        width: \"100%\",\r\n        padding: 5,\r\n    },\r\n    loaderDropzone: {\r\n        textAlign: \"center\",\r\n        backgroundColor: theme.palette.background.default,\r\n        height: 120,\r\n        display: \"flex\",\r\n        justifyContent: \"center\",\r\n        alignItems: \"center\"\r\n    }\r\n\r\n}));\r\n\r\n// Class used for converting the alternate history editor save to the most recent save version in that app\r\n// This file aims to ensure back-ward compatibility of save files\r\n// Right now im doing a graduated thing of converting 1.0 to 1.1 and 1.1 to 1.2 and so on via functions for each, maybe it gets bad later but it'll be easy to refactor I assume so should be fine\r\nclass Loader { // Class which loads saves into the app, converting them regardless of version to the current version\r\n    constructor() {\r\n        this.currentSaveVersion = \"1.2\";\r\n    }\r\n\r\n    processSave(save) { // takes json parsed object file from menubar and converts it to the newest version\r\n        let version = this.detectSaveVersion(save);\r\n\r\n        if (version === \"1.0\") {\r\n            return this.processSave(this.one_zero_to_one_one(save));\r\n        } else if (version == \"1.1\") {\r\n            return this.one_one_to_one_two(save);\r\n        } else if (version == this.currentSaveVersion) { // no modification needed\r\n            return save;\r\n        }\r\n    }\r\n\r\n    one_one_to_one_two(save) { // converts 1.1 ver save to 1.2 ver save TODO: slight concerns as maybe pass by reference not value;\r\n        save.version = this.currentSaveVersion;\r\n        save.customMap = false; // 1.1 version saves didn't have non-inbuilt custom maps\r\n        save.customMapGeojson = false; // same reason as above\r\n        return save;\r\n    }\r\n\r\n    one_zero_to_one_one(save) { // converts 1.0 ver save to 1.1 ver save TODO: slight concerns as maybe pass by reference not value\r\n        save.version = \"1.1\";\r\n        let order = 0;\r\n        Object.values(save.entryDict).forEach(entry => {\r\n            // Assigns order based on current order of entryDict (which is insertion order I think if I remembered correction for such string keys)\r\n            entry[\"order\"] = order;\r\n            order++;\r\n        });\r\n        return save;\r\n    }\r\n\r\n    detectSaveVersion(save) { // detects save version from\r\n        if (\"version\" in save) { // case of versions from 1.1 onwards which has\r\n            return save.version;\r\n        } else { // case of version 1.0, as it didn't have a version attribute\r\n            return \"1.0\";\r\n        }\r\n    }\r\n}\r\n\r\n// Instance of the Loader class\r\nconst loader = new Loader();\r\n\r\n// Converts alternate history editor saves to the format appropriate for this this app\r\n// Expects a single file object, one that is compatible with JSON.stringify after processing\r\n// Returns the JSON object\r\nfunction loadScenario(app, file, onload = null) {\r\n    file.text().then(text => {\r\n        const obj = loader.processSave(JSON.parse(text));\r\n        if (obj.mapType === \"admin\") {\r\n            let convertedObj = {\r\n                scenarioData: [],\r\n                colorData: [],\r\n                pluginData: {},\r\n            };\r\n            // Generate scenarioData\r\n            Object.values(obj.entryDict).forEach(entry => {\r\n                let regionDict = cloneDeep(app.regionDictDefault);\r\n                for (const [index, color] of Object.entries(entry.mapData)) {\r\n                    if (!(index === \"undefined\")) { // We use string \"undefined\" for that seems to be what the json loading gives from the saves\r\n                        regionDict[index].color = csscolors[color];\r\n                    }\r\n                }\r\n                convertedObj.scenarioData.push(createScenarioEntry(regionDict, entry.date, entry.event));\r\n            });\r\n\r\n            // Generate colorData (due to known issues with the alternate history editor's count of colors, we shall count colors from mapData directly as opposed to using legendData in the save)\r\n            // Color string dict is here for a mapping from hex to string for later on when we wish to use refer to color tags in the save (which are in the form of a string) via hex codes in the generated colorDict\r\n            let colorStringDict = {};\r\n            Object.values(obj.entryDict).forEach(entry => {\r\n                let colorEntry = {};\r\n                for (const [index, color] of Object.entries(entry.mapData)) {\r\n                    if (!(index === \"undefined\")) { // We use string \"undefined\" for that seems to be what the json loading gives from the saves\r\n                        if (csscolors[color] in colorEntry) {\r\n                            colorEntry[csscolors[color]] += 1;\r\n                        } else {\r\n                            colorEntry[csscolors[color]] = 1;\r\n                        }\r\n\r\n                        // Update colorStringDict if the color concerned isn't in there already\r\n                        if (!(color in colorStringDict)) {\r\n                            colorStringDict[csscolors[color]] = color;\r\n                        }\r\n                    }\r\n                }\r\n                convertedObj.colorData.push(colorEntry);;\r\n            });\r\n\r\n            // Generate pluginData\r\n            // Initialise pluginData first\r\n            let pluginData = {};\r\n            for (const [name, entry] of Object.entries(app.plugins)) {\r\n                pluginData[name] = entry.initState(convertedObj.scenarioData);\r\n            };\r\n            // Modify pluginData entries (in comparison to the initstate case) that need to be changed according to our save, in this case at the time of writing only legend need to have its data modified\r\n            // Generate Legend data\r\n            pluginData[\"Legend\"] = [];\r\n            Object.values(obj.entryDict).forEach((entry, index) => {\r\n                // Note this index is note the same as those in obj, in obj the index starts from 1, here it starts from 0\r\n                let legendEntry = {};\r\n                for (const color of Object.keys(convertedObj.colorData[index])) {\r\n                    if (colorStringDict[color] in entry.legendData) {\r\n                        legendEntry[color] = entry.legendData[colorStringDict[color]].entry;\r\n                    } else {\r\n                        legendEntry[color] = \"None\";\r\n                    }\r\n                }\r\n                pluginData[\"Legend\"].push(legendEntry);\r\n            });\r\n            convertedObj.pluginData = pluginData;\r\n\r\n            // Load converted save\r\n            if (onload) {\r\n                onload(convertedObj);\r\n            }\r\n\r\n        } else {\r\n            console.log(\"Error: currently only supports importing admin map saves\")\r\n        }\r\n    });\r\n}\r\n\r\nfunction AltHistEditorLoaderPluginComponent(props) {\r\n    const classes = useStyles();\r\n    return (\r\n        <div className={classes.altHistEditorLoaderContainer}>\r\n            <Dropzone\r\n                onDrop={acceptedFiles => {\r\n                    loadScenario(props.app, acceptedFiles[0], props.app.loadSave);\r\n                }}\r\n            >\r\n                {({ getRootProps, getInputProps }) => (\r\n                    <div {...getRootProps()}>\r\n                        <input {...getInputProps()} />\r\n                        <div className={classes.loaderDropzone}>\r\n                            <div>\r\n                                Drop your save here, or click to select file\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n            </Dropzone>\r\n        </div>\r\n    );\r\n}\r\n\r\nconst initState = scenarioData => {\r\n    return null;\r\n};\r\n\r\nconst AltHistEditorLoaderPluginDict = {\r\n    component: AltHistEditorLoaderPluginComponent,\r\n    initState: initState,\r\n    help: \"For loading saves from Alternate History Editor.\",\r\n    functions: {}\r\n};\r\n\r\nexport default AltHistEditorLoaderPluginDict;","import scen2800BC from \"./2800BC-Epic-of-Gilgamesh.json\";\r\nimport scen1279BC from \"./1279BC-Ozymandias-King-of-Kings.json\";\r\nimport scen356BC from \"./356BC-Birth-of-Alexander.json\";\r\nimport scen117 from \"./117-Pax-Romana.json\";\r\nimport scen565 from \"./565-The-Last-Roman.json\";\r\nimport scen867 from \"./867-Macedonian-Dynasty.json\";\r\nimport scen1206 from \"./1206-Rise-of-Mongolia.json\";\r\nimport scen1444 from \"./1444-Battle-of-Varna.json\";\r\nimport scen1789 from \"./1789-French-Revolution.json\";\r\nimport scen1861 from \"./1861-American-Civil-War.json\";\r\nimport scen1936 from \"./1936-Coming-of-the-Storm.json\"\r\n\r\n// Import json scenarios, keys should be names that will be displayed for the scenario\r\nconst scenarios = {\r\n  \"2800BC Epic of Gilgamesh\": scen2800BC,\r\n  \"1279BC Ozymandias, King of Kings\": scen1279BC,\r\n  \"356BC Birth of Alexander\": scen356BC,\r\n  \"117 Pax Romana\": scen117,\r\n  \"565 The Last Roman\": scen565,\r\n  \"867 Macedonian Dynasty\": scen867,\r\n  \"1206 Rise of Mongolia\": scen1206,\r\n  \"1444 Battle of Varna\": scen1444,\r\n  \"1789 French Revolution\": scen1789,\r\n  \"1861 American Civil War\": scen1861,\r\n  \"1936 Coming of the Storm\": scen1936,\r\n};\r\n\r\nexport default scenarios;","// Import community scenarios; this is where to import; put the files in src/assets/communityScenario, import them here, then add them to the scenarios dictionary below\r\nimport scen1914 from \"./1914-WWI.json\";\r\nimport scen2021 from \"./2021-Modern-Map-made-by-DawnbreakZ-edited-by-yunus3663.json\";\r\n\r\n// Import json scenarios, keys should be names that will be displayed for the scenario\r\nconst comScenarios = {\r\n  \"1914 WWI\": scen1914,\r\n  \"2021 Modern Map made by DawnbreakZ edited by yunus3663\": scen2021,\r\n}\r\n\r\nexport default comScenarios;","import React from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Select from '@material-ui/core/Select';\r\nimport Button from '@material-ui/core/Button';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport ListSubheader from '@material-ui/core/ListSubheader';\r\n\r\n// Import scenarios\r\nimport scenarios from \"../assets/scenario/scenarios.js\";\r\nimport comScenarios from \"../assets/communityScenario/comScenarios.js\";\r\n\r\n// Setup styles\r\nconst useStyles = makeStyles((theme) => ({\r\n    scenarioContainer: {\r\n        backgroundColor: theme.palette.background.paper,\r\n        width: \"calc(100% - 10px)\", // This subtraction corresponds to the padding of the parent\r\n        padding: 5,\r\n        display: \"flex\",\r\n        flexFlow: \"column\",\r\n        alignItems: \"center\",\r\n        justifyContent: \"flex-start\",\r\n    },\r\n    scenarioSelect: {\r\n        fontSize: 12,\r\n        width: \"calc(100% - 10px)\",\r\n    }\r\n}));\r\n\r\n// Load file \r\nfunction ScenarioPluginComponent(props) {\r\n    const classes = useStyles();\r\n    const [selectedScenario, setSelectedScenario] = React.useState(Object.keys(scenarios)[0]);\r\n    return (\r\n        <div id=\"scenario\" className={classes.scenarioContainer}>\r\n            <Select\r\n                value={selectedScenario}\r\n                className={classes.scenarioSelect}\r\n                onChange={e => {setSelectedScenario(e.target.value);}}\r\n            >\r\n                <ListSubheader>Base Scenarios</ListSubheader>\r\n                {Object.keys(scenarios).map(key => <MenuItem key={key} value={key}>\r\n                    {key}\r\n                </MenuItem>)}\r\n                <ListSubheader>Community-made Scenarios</ListSubheader>\r\n                {Object.keys(comScenarios).map(key => <MenuItem key={key} value={key}>\r\n                    {key}\r\n                </MenuItem>)}\r\n            </Select>\r\n            <Button size=\"small\" onClick={() => {\r\n                // Load save from appropriate dictionary based on what dictionary the key is in TODO: this is not the most efficient way to do it IMO, better to use I gess some label for quicker access\r\n                if (selectedScenario in scenarios) {\r\n                    props.app.loadSave(scenarios[selectedScenario]);\r\n                } else {\r\n                    props.app.loadSave(comScenarios[selectedScenario]);\r\n                }\r\n            }}>Load</Button>\r\n        </div>\r\n    );\r\n}\r\n\r\nconst initState = scenarioData => {\r\n    return null;\r\n};\r\n\r\nconst ScenarioPluginDict = {\r\n    component: ScenarioPluginComponent,\r\n    initState: initState,\r\n    help: \"For loading several premade scenarios.\",\r\n    functions: {}\r\n};\r\n\r\nexport default ScenarioPluginDict;","import React from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Dropzone from 'react-dropzone';\r\n\r\n// This should be used both for loading saves made with custom geojsons and for loading a custom geojson\r\n// To remove this plugin completely, technically just remove it from plugin list, but there is the mapKey attribute in the App.js which facilitates the plugin which I guess is needed for it to work well\r\n\r\n// Setup styles\r\nconst useStyles = makeStyles((theme) => ({\r\n    customGeoJSONLoaderContainer: {\r\n        backgroundColor: theme.palette.background.paper,\r\n        width: \"calc(100% - 10px)\", // This subtraction corresponds to the padding of the parent\r\n        padding: 5,\r\n        display: \"flex\",\r\n        flexFlow: \"column\",\r\n        alignItems: \"center\",\r\n        justifyContent: \"flex-start\",\r\n    },\r\n    loaderDropzone: {\r\n        textAlign: \"center\",\r\n        backgroundColor: theme.palette.background.default,\r\n        height: 120,\r\n        display: \"flex\",\r\n        justifyContent: \"center\",\r\n        alignItems: \"center\"\r\n    }\r\n}));\r\n\r\n// Function for loading such file\r\n// Expects geoJSON either alone or part of a save to be of format, i.e. polygons have name, regionID attributes\r\nfunction loadGeoJSON(app, file) {\r\n    const name = file.name;\r\n    file.text().then(text => {\r\n        const obj = JSON.parse(text);\r\n        if (\"scenarioData\" in obj) {\r\n            // This is used to test obj is a save, not a geoJSON\r\n            // Expects the file to have valid data, i.e. pluginData for GeoJSON loader and appropriate scenario data, colorDict, etc.\r\n            // First load in the basemap and map key\r\n            app.resetAppBasedOnBasemap(obj.pluginData[\"Custom GeoJSON Loader\"].baseMap, obj.pluginData[\"Custom GeoJSON Loader\"].mapKey, () => {\r\n                app.updatePluginData(\"Custom GeoJSON Loader\", {\r\n                    mapKey: name, \r\n                    baseMap: obj, // TODO: could be optimised so to instead of saving inmemeory two copies of such basemap, just save 1 copy, and say pass an argyument to resetAppBasedOnBasemap\r\n                })\r\n            });\r\n            // Then load save as usual\r\n            app.loadSave(obj);\r\n        } else {\r\n            // Assumes then the loaded file is geoJSON\r\n            // Reset app based on these two updated values, baseMap and mapKey, then run callupdate to update the relevant pluginData, both mapKey and geoJSON map to record the data of the map there so saves will work\r\n            app.resetAppBasedOnBasemap(obj, name, () => {\r\n                app.updatePluginData(\"Custom GeoJSON Loader\", {\r\n                    mapKey: name, \r\n                    baseMap: obj, // TODO: could be optimised so to instead of saving inmemeory two copies of such basemap, just save 1 copy, and say pass an argyument to resetAppBasedOnBasemap\r\n                })\r\n            });\r\n        }\r\n    });\r\n}\r\n\r\n// Load file \r\nfunction CustomGeoJSONLoaderPluginComponent(props) {\r\n    const classes = useStyles();\r\n    return (\r\n        <div id=\"geojson_loader\" className={classes.customGeoJSONLoaderContainer}>\r\n            <Dropzone\r\n                onDrop={acceptedFiles => {\r\n                    loadGeoJSON(props.app, acceptedFiles[0]);\r\n                }}\r\n            >\r\n                {({ getRootProps, getInputProps }) => (\r\n                    <div {...getRootProps()}>\r\n                        <input {...getInputProps()} />\r\n                        <div className={classes.loaderDropzone}>\r\n                            <div>\r\n                                Drop your save here, or click to select file\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n            </Dropzone>\r\n        </div>\r\n    );\r\n}\r\n\r\nconst initState = scenarioData => {\r\n    return null;\r\n};\r\n\r\nconst CustomGeoJSONLoaderPluginDict = {\r\n    component: CustomGeoJSONLoaderPluginComponent,\r\n    initState: initState,\r\n    help: \"For loading custom region geoJSON or saves with custom regions. See help for tutorial\",\r\n    functions: {}\r\n};\r\n\r\nexport default CustomGeoJSONLoaderPluginDict;","import React from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport DoneIcon from '@material-ui/icons/Done';\r\nimport cloneDeep from 'clone-deep';\r\n\r\n// Setup styles\r\nconst useStyles = makeStyles((theme) => ({\r\n    themeContainer: {\r\n        backgroundColor: theme.palette.background.paper,\r\n        width: \"calc(100% - 10px)\", // This subtraction corresponds to the padding of the parent\r\n        padding: 5,\r\n        display: \"flex\",\r\n        flexFlow: \"column\",\r\n        alignItems: \"center\",\r\n        justifyContent: \"flex-start\",\r\n    },\r\n    themeInput: {\r\n        transform: \"scale(0.8)\",\r\n    }\r\n}));\r\n\r\n// Constant list of themeDict entries that are customizable\r\nconst custTheme = [\r\n    \"polyStrokeColor\",\r\n    \"polyStrokeWeight\",\r\n    \"polyFillColorDefault\",\r\n    \"polyFillOpacityDefault\",\r\n    \"polyFillOpacityColored\",\r\n    \"polyFillOpacityHovered\",\r\n    \"markerSize\",\r\n]\r\n\r\n// Constant list of functions for ensuring type of values in theme input fields are read correctly\r\nconst custThemeType = {\r\n    \"polyStrokeColor\": \"text\",\r\n    \"polyStrokeWeight\": \"number\",\r\n    \"polyFillColorDefault\": \"text\",\r\n    \"polyFillOpacityDefault\": \"number\",\r\n    \"polyFillOpacityColored\": \"number\",\r\n    \"polyFillOpacityHovered\": \"number\",\r\n    \"markerSize\": \"number\",\r\n};\r\nconst typeConvFunc = {\r\n    \"text\": String,\r\n    \"number\": Number,\r\n};\r\n\r\n// Labels to display in the theme panel as opposed to original labels\r\nconst fieldLabels = {\r\n    \"polyStrokeColor\": \"Reg. border color\",\r\n    \"polyStrokeWeight\": \"Reg. border width\",\r\n    \"polyFillColorDefault\": \"Default reg. color\",\r\n    \"polyFillOpacityDefault\": \"Default reg. opacity\",\r\n    \"polyFillOpacityColored\": \"Colored reg. opacity\",\r\n    \"polyFillOpacityHovered\": \"Hovered reg. opacity\",\r\n    \"markerSize\": \"Marker size\",\r\n};\r\n\r\n// Load file \r\nfunction ThemePluginComponent(props) {\r\n    const classes = useStyles();\r\n    const [themeDict, setThemeDict] = React.useState(props.app.state.themeDict.other);\r\n    const fields = Object.entries(themeDict).map(entry => {\r\n        if (custTheme.includes(entry[0])) {\r\n            return (<TextField\r\n                className={classes.themeInput}\r\n                key={entry[0]}\r\n                value={entry[1]}\r\n                label={fieldLabels[entry[0]]}\r\n                margin=\"dense\"\r\n                type={custThemeType[entry[0]]}\r\n                onChange={e => {\r\n                    let newTheme = cloneDeep(themeDict);\r\n                    newTheme[entry[0]] = typeConvFunc[custThemeType[entry[0]]](e.target.value);\r\n                    setThemeDict(newTheme);\r\n                }}\r\n            />)\r\n        }\r\n    });\r\n    return (\r\n        <div id=\"theme_panel\" className={classes.themeContainer}>\r\n            {fields}\r\n            <IconButton size=\"small\" onClick={() => {\r\n                let newTheme = cloneDeep(props.app.state.themeDict);\r\n                newTheme.other = themeDict;\r\n                props.app.setState({ themeDict: newTheme }, () => {\r\n                    props.app.mapRef.current.resetAllRegionStyle();\r\n                });\r\n            }}>\r\n                <DoneIcon />\r\n            </IconButton>\r\n        </div>\r\n    );\r\n}\r\n\r\nconst initState = scenarioData => {\r\n    return null;\r\n};\r\n\r\nconst ThemePluginDict = {\r\n    component: ThemePluginComponent,\r\n    initState: initState,\r\n    help: \"For modifying map visuals.\",\r\n    functions: {}\r\n};\r\n\r\nexport default ThemePluginDict;","import React from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Button from '@material-ui/core/Button';\r\nimport Input from '@material-ui/core/Input';\r\nimport Popper from '@material-ui/core/Popper';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport cloneDeep from \"clone-deep\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\n\r\n// Import icons\r\nimport markerIcons from \"../assets/other/markerIcons.js\";\r\n\r\n// Setup styles\r\nconst useStyles = makeStyles((theme) => ({\r\n    markerContainer: {\r\n        backgroundColor: theme.palette.background.paper,\r\n        width: \"calc(100% - 10px)\", // This subtraction corresponds to the padding of the parent\r\n        padding: 5,\r\n        display: \"flex\",\r\n        flexFlow: \"column\",\r\n        alignItems: \"center\",\r\n        justifyContent: \"flex-start\",\r\n    },\r\n    iconSelect: {\r\n        zIndex: 3,\r\n        height: 80,\r\n        display: \"flex\",\r\n        flexFlow: \"row\",\r\n        alignItems: \"center\",\r\n        justifyContent: \"space-evenly\",\r\n        width: \"100%\",\r\n    },\r\n    iconDisplay: {\r\n        height: 30,\r\n        width: 30,\r\n    },\r\n    iconColorInput: {\r\n        width: 40,\r\n        height: 40,\r\n    },\r\n    iconList: {\r\n        zIndex: 1,\r\n        backgroundColor: theme.palette.background.paper,\r\n        color: theme.palette.text.primary,\r\n        padding: 5,\r\n    },\r\n    iconListEntry: {\r\n        height: 20,\r\n        width: 20,\r\n    },\r\n    markerHelp: {\r\n        width: \"100%\",\r\n    }\r\n}));\r\n\r\n// Function to run when active entry is updated, this updates the markerData in the mapComponent, then reloads the markers\r\nfunction onUpdateActiveEntry(app, newIndex) {\r\n    app.mapRef.current.updateMarkerData();\r\n}\r\n\r\nfunction onAddEntry(app, index) {\r\n    let currentMarkerData = cloneDeep(app.state.pluginData[\"Marker\"]);\r\n    let newMarkerEntry = null;\r\n    if (index > 0) { // Use new\r\n        newMarkerEntry = cloneDeep(currentMarkerData[index - 1]);\r\n    } else { // Use default\r\n        newMarkerEntry = {};\r\n    }\r\n    currentMarkerData.splice(index, 0, newMarkerEntry);\r\n    return currentMarkerData;\r\n}\r\n\r\nfunction onDeleteEntry(app, index) {\r\n    let currentMarkerData = cloneDeep(app.state.pluginData[\"Marker\"]);\r\n    currentMarkerData.splice(index, 1);\r\n    return currentMarkerData;\r\n\r\n}\r\n\r\n// Icon selection component\r\nfunction IconSelector(props) {\r\n    const classes = useStyles();\r\n    const [anchorEl, setAnchorEl] = React.useState(null);\r\n\r\n    const handleClick = (event) => {\r\n        setAnchorEl(anchorEl ? null : event.currentTarget);\r\n    };\r\n\r\n    const open = Boolean(anchorEl);\r\n    const id = open ? 'simple-popper' : undefined;\r\n\r\n    const Icon = props.value;\r\n\r\n    const iconChoices = markerIcons.map((MarkerIcon, index) => (\r\n        <MarkerIcon\r\n            key={index}\r\n            className={classes.iconListEntry}\r\n            style={{color:props.color}}\r\n            onClick={() => {\r\n                props.updateIconIndex(index);\r\n                handleClick();\r\n            }}\r\n        />\r\n    ));\r\n\r\n    return (\r\n        <div>\r\n            <Icon className={classes.iconDisplay} style={{ color: props.color }} onClick={handleClick}/>\r\n            <Popper className={classes.iconList} id={id} open={open} anchorEl={anchorEl} disablePortal>\r\n                <Grid>\r\n                    {iconChoices}\r\n                </Grid>\r\n            </Popper>\r\n        </div>\r\n    )\r\n}\r\n\r\n// Marker component\r\nfunction MarkerPluginComponent(props) {\r\n    const classes = useStyles();\r\n    const [color, setColor] = React.useState(\"#bf4340\");// Default color of icons\r\n    const [iconIndex, setIconIndex] = React.useState(0);// Defaults to first icon in list\r\n\r\n    const Icon = markerIcons[iconIndex];\r\n\r\n    return (\r\n        <div id=\"marker_panel\" className={classes.markerContainer}>\r\n            <Typography className={classes.markerHelp} align=\"left\" variant=\"caption\">Choose icon: click icon</Typography>\r\n            <Typography className={classes.markerHelp} align=\"left\" variant=\"caption\">Choose color: click rectangle.</Typography>\r\n            <Typography className={classes.markerHelp} align=\"left\" variant=\"caption\">Drag icon: click and hold.</Typography>\r\n            <Typography className={classes.markerHelp} align=\"left\" variant=\"caption\">Remove icon or view/edit its tooltip: click icon on the map.</Typography>\r\n            <div className={classes.iconSelect}>\r\n                <IconSelector value={Icon} color={color} updateIconIndex={setIconIndex}/>\r\n                <Input className={classes.iconColorInput} value={color} type=\"color\" onChange={e => setColor(e.target.value)} />\r\n            </div>\r\n            <Button onClick={() => {\r\n                const center = props.app.mapRef.current.mapElement.getBounds().getCenter();\r\n                props.app.mapRef.current.addMarker(iconIndex, color, center.lat, center.lng, \"This is editable.\");\r\n            }}>\r\n                Add\r\n            </Button>\r\n        </div>\r\n    );\r\n}\r\n\r\nconst initState = scenarioData => {\r\n    let retval = [];\r\n    let i;\r\n    for (i = 0; i < scenarioData.length; i++) {\r\n        retval.push({});\r\n    }\r\n    return retval;\r\n};\r\n\r\nconst MarkerPluginDict = {\r\n    component: MarkerPluginComponent,\r\n    initState: initState,\r\n    help: \"For adding colored markers to the map.\",\r\n    functions: {\r\n        onUpdateActiveEntry: onUpdateActiveEntry,\r\n        onAddEntry: onAddEntry,\r\n        onDeleteEntry: onDeleteEntry,\r\n    }\r\n};\r\n\r\nexport default MarkerPluginDict;","// This is where to import the individual plugins, i.e. this is the list of plugins you wish to add to the app toolmenu\r\n// For sake of consistency, it is recommended to save the plugin component files in src/plugins; but of course you can save it anywhere you like and import it to this js file\r\nimport LegendPlugin from './plugins/LegendPlugin.js'; // Naming the plugins with Component is not required, it could have well been just Legend, given the source plugin file is named as such, having Plugin in the name is just due to personal preferences\r\nimport RegionInfoPlugin from './plugins/RegionInfoPlugin.js';\r\nimport AltHistEditorLoaderPlugin from './plugins/AltHistEditorLoaderPlugin.js';\r\nimport ScenarioPlugin from './plugins/ScenarioPlugin.js';\r\nimport CustomGeoJSONLoaderPlugin from './plugins/CustomGeoJSONLoaderPlugin.js';\r\nimport ThemePlugin from './plugins/ThemePlugin.js';\r\nimport MarkerPlugin from './plugins/MarkerPlugin';\r\n\r\n// All imported plugins above should then be listed below with their names, which will serve as the title in the plugins menu\r\n// Names of plugins should be unique as they will also serve as keys to the accordion element\r\n// See LegendPlugin.js for example of plugin and the requirements of it \r\n// The ordering of plugins here also determine the order of plugin display in the app\r\nconst plugins = {\r\n    \"Region Info\": RegionInfoPlugin,\r\n    \"Legend\": LegendPlugin,\r\n    \"Marker\": MarkerPlugin,\r\n    \"Scenario\": ScenarioPlugin,\r\n    \"Theme\": ThemePlugin,\r\n    \"Alt Hist Editor Loader\": AltHistEditorLoaderPlugin, \r\n    \"Custom GeoJSON Loader\": CustomGeoJSONLoaderPlugin,\r\n};\r\n\r\nexport default plugins;","import React, { useDebugValue } from \"react\";\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport plugins from \"../appPlugins.js\";\r\nimport Accordion from '@material-ui/core/Accordion';\r\nimport AccordionSummary from '@material-ui/core/AccordionSummary';\r\nimport AccordionDetails from '@material-ui/core/AccordionDetails';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Scrollbars from 'react-custom-scrollbars';\r\nimport Slide from '@material-ui/core/Slide';\r\nimport HelpOutlineIcon from '@material-ui/icons/HelpOutline';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\n\r\n// Import retract button custom component\r\nimport RetractButton from './RetractButton.js';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    pluginMenuContainer: {\r\n        position: \"absolute\",\r\n        right: 0,\r\n        bottom: 80,\r\n        zIndex: 1,\r\n        minWidth: 140, // At least 150px adding in padding\r\n        width: \"12%\",\r\n        minHeight: 170, // At least 180px adding in padding\r\n        height: \"60%\",\r\n        display: \"flex\",\r\n        justifyContent: \"flex-start\",\r\n        flexFlow: \"column\",\r\n        alignItems: \"stretch\",\r\n        paddingTop: 5,\r\n        paddingBottom: 5,\r\n        transform: \"translate(0%, -50%)\",\r\n        borderTopStyle: \"ridge\",\r\n        borderBottomStyle: \"ridge\",\r\n        borderLeftStyle: \"ridge\",\r\n        borderColor: theme.palette.border,\r\n        backgroundImage: theme.palette.backgroundImage.main,\r\n        WebkitBorderImage: theme.palette.borderImage\r\n    },\r\n    accordionContainer: {\r\n        paddingRight: 5,\r\n        paddingLeft: 5,\r\n    },\r\n    accordionSummary: {\r\n        paddingTop: 0,\r\n        paddingBottom: 0,\r\n    },\r\n    accordionDetails: {\r\n        padding: 0,\r\n    },\r\n    accordionHelp: {\r\n        marginLeft: 5,\r\n    },\r\n    accordionItemContainer: {\r\n        borderRadius: 3,\r\n    }\r\n}));\r\n\r\nexport default function PluginMenuComponent(props) {\r\n    const classes = useStyles();\r\n    const [display, setDisplay] = React.useState(true);\r\n    let accordionItems = [];\r\n    for (const [name, value] of Object.entries(plugins)) {\r\n        const Plugin = value.component;\r\n        accordionItems.push(\r\n            <Accordion defaultExpanded key={name} className={classes.accordionItemContainer} square>\r\n                <AccordionSummary expandIcon={<ExpandMoreIcon />} className={classes.accordionSummary} IconButtonProps={{ size: \"small\" }}>\r\n                    <Typography variant=\"body2\">{name}</Typography>\r\n                    <Tooltip\r\n                        title={value.help}\r\n                    >\r\n                        <div className={classes.accordionHelp}>\r\n                            <HelpOutlineIcon fontSize=\"small\"/>\r\n                        </div>\r\n                    </Tooltip>\r\n                </AccordionSummary>\r\n                <AccordionDetails className={classes.accordionDetails}>\r\n                    <Plugin app={props.app} />\r\n                </AccordionDetails>\r\n            </Accordion>\r\n        );\r\n    }\r\n    return (\r\n        <Slide direction=\"left\" in={display} unmountOnExit={false} mountOnEnter={false}>\r\n            <div className={classes.pluginMenuContainer} id=\"plugin_menu\">\r\n                <Scrollbars>\r\n                    <div className={classes.accordionContainer}>\r\n                        {accordionItems}\r\n                    </div>\r\n                </Scrollbars>\r\n                <RetractButton direction=\"right\" top={\"50%\"} left={-6} checked={display} onClick={() => setDisplay(!display)} />\r\n            </div>\r\n        </Slide>\r\n    );\r\n}","import { makeStyles } from '@material-ui/core/styles';\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport IconButton from '@material-ui/core/IconButton';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    addIconButtonContainer: {\r\n        position: \"absolute\",\r\n        top: -12,\r\n        padding: 0,\r\n        zIndex: 1,\r\n        transform: \"scale(0.8)\"\r\n    },\r\n    addIconButton: {\r\n        padding: 0,\r\n        zIndex: 2,\r\n        color: theme.palette.text.secondary,\r\n    },\r\n}));\r\n\r\nexport default function TimelineAddButton(props) {\r\n    const classes = useStyles();\r\n    return (\r\n        <div>\r\n            <div className={classes.addIconButtonContainer} style={{left : props.themeDict.timelineMarkerSpacing/2 + 16}}>\r\n                <IconButton size=\"small\" className={classes.addIconButton} onClick={(e) => { props.addEntry(props.index + 1); e.stopPropagation();}}>\r\n                    {/*This is the fake button for visuals only*/}\r\n                    <AddIcon></AddIcon>\r\n                </IconButton>\r\n            </div>\r\n        </div>\r\n    );\r\n}","// Import packages\r\nimport React from \"react\";\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport RadioButtonUncheckedIcon from '@material-ui/icons/RadioButtonUnchecked';\r\nimport RadioButtonCheckedIcon from '@material-ui/icons/RadioButtonChecked';\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport TimelineAddButton from './TimelineAddButton.js';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    timelineMarker: {\r\n        position: \"absolute\",\r\n        top: 15,\r\n        zIndex: 2,\r\n        transform: \"scale(0.8)\",\r\n    },\r\n    entryButton: {\r\n        color: theme.palette.text.primary,\r\n        padding: 0,\r\n    },\r\n    markerLabel: {\r\n        position: \"absolute\",\r\n        top: -20,\r\n        left: \"50%\",\r\n        textAlign: \"center\",\r\n        textOverflow: \"ellipsis\",\r\n        overflow: \"hidden\",\r\n        whiteSpace: \"nowrap\",\r\n        color: theme.palette.text.primary\r\n    },\r\n}));\r\n\r\nexport default function TimelineMarker(props) {\r\n    const classes = useStyles();\r\n    const icon = props.selected ? <RadioButtonCheckedIcon/> : <RadioButtonUncheckedIcon/>;\r\n    return (\r\n        <div className={classes.timelineMarker} style={{left: (props.index+1)*props.themeDict.timelineMarkerSpacing}}>\r\n            {/*props.index+1 as we wish to add after the current entry*/}\r\n            <Typography\r\n                id={\"timeline_marker_\" + props.index}\r\n                className={classes.markerLabel}\r\n                variant=\"body2\"\r\n                style={{\r\n                    width:props.themeDict.timelineMarkerLabelWidth,\r\n                    marginLeft:-props.themeDict.timelineMarkerLabelWidth/2,\r\n                }}\r\n            >\r\n            {props.label}\r\n            </Typography>\r\n            <TimelineAddButton themeDict={props.themeDict} addEntry={props.addEntry} index={props.index}/>\r\n            <IconButton className={classes.entryButton} size=\"small\" onClick={() => {props.updateActiveEntry(props.index);}}>\r\n                {icon}\r\n            </IconButton>\r\n        </div>\r\n    );\r\n}","// Import packages\r\nimport React from \"react\";\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport { Scrollbars } from 'react-custom-scrollbars';\r\n\r\n// Import custom components\r\nimport TimelineMarker from './TimelineMarker.js';\r\n\r\n// Import script\r\nimport useWindowSize from '../scripts/useWindowSize.js';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    timelineBarContainer: {\r\n        position: \"absolute\",\r\n        width: \"100%\",\r\n        height: 45, // If this is adjusted, need to adjust the height of the map element and event component as well so that the top of the timeline meets the bottom of the map\r\n        bottom: 0,\r\n        overflow: \"hidden\",\r\n        zIndex: 2,\r\n        borderTopStyle: \"ridge\",\r\n        borderColor: theme.palette.border,\r\n        backgroundImage: theme.palette.backgroundImage.main,\r\n        WebkitBorderImage: theme.palette.borderImage\r\n    },\r\n    timelineLine: {\r\n        position: \"absolute\",\r\n        top: 26,\r\n        left: 0,\r\n        height: 2,\r\n        backgroundColor: theme.palette.text.primary,\r\n    },\r\n    timelineBarContentContainer: {\r\n        display: \"relative\",\r\n        height: \"100%\",\r\n    },\r\n    timelineBarMarkerContainer: {\r\n        position: \"absolute\",\r\n        top: 0,\r\n        left: 0,\r\n    }\r\n}));\r\n\r\nexport default function TimelineBarComponent(props) {\r\n    const classes = useStyles();\r\n    const markers = props.scenarioData.map((entry, index) =>\r\n        <TimelineMarker key={index} index={index} label={entry.date} selected={props.activeEntry === index} updateActiveEntry={props.updateActiveEntry} addEntry={props.addEntry} themeDict={props.themeDict} />\r\n    )\r\n    const [width, height] = useWindowSize(); // Values that change whenever window is resized, height is not used for now TODO: get rid of height part if performacne suffers, else overhead I guess is fine\r\n    const lineLength = Math.max(width, (props.scenarioData.length + 1) * props.themeDict.timelineMarkerSpacing); // Take the larger of the viewport width and the length required to fit the timeline markers as the length of the timeline TODO: the issue of what I've done here is that the right end and the left end of the timeline won't match up in length when the second line length case in the max arguments is triggered, not too important, but fix it if possible\r\n    return (\r\n        <div className={classes.timelineBarContainer} id=\"timeline_bar\">\r\n            <Scrollbars className={classes.timelineBarContentContainer}>\r\n                <div className={classes.timelineBarContentContainer}>\r\n                    <div className={classes.timelineLine} style={{ width: lineLength }}></div>\r\n                    <div className={classes.timelineBarMarkerContainer} style={{ width: lineLength }}>\r\n                        {markers}\r\n                    </div>\r\n                </div>\r\n            </Scrollbars>\r\n        </div>\r\n    );\r\n}","import React from \"react\";\r\n\r\n// Function for listener on windows resize\r\nexport default function useWindowSize() {\r\n    const [size, setSize] = React.useState([0, 0]);\r\n    React.useLayoutEffect(() => {\r\n        function updateSize() {\r\n            setSize([window.innerWidth, window.innerHeight]);\r\n        }\r\n        window.addEventListener('resize', updateSize);\r\n        updateSize();\r\n        return () => window.removeEventListener('resize', updateSize);\r\n    }, []);\r\n    return size;\r\n}","// Import React\r\nimport React from \"react\";\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Slide from '@material-ui/core/Slide';\r\n\r\n// Import retract button custom component\r\nimport RetractButton from './RetractButton.js';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    eventContainer: {\r\n        position: \"absolute\",\r\n        left: 0,\r\n        bottom: 48, // This value should be such that the event box touches the timeline bar on the bottom, so adjust accordingly\r\n        minWidth: 140,\r\n        width: \"20%\",\r\n        height: 250,\r\n        zIndex: 1,\r\n        display: \"flex\",\r\n        flexFlow: \"column\",\r\n        alignItems: \"stretch\",\r\n        padding: 5,\r\n        borderRightStyle: \"ridge\",\r\n        borderTopStyle: \"ridge\",\r\n        borderColor: theme.palette.border,\r\n        backgroundImage: theme.palette.backgroundImage.main,\r\n        WebkitBorderImage: theme.palette.borderImage\r\n    },\r\n    eventBar: {\r\n        display: \"flex\",\r\n        flexFlow: \"row\",\r\n        alignItems: \"center\",\r\n        justifyContent: \"space-between\",\r\n        backgroundImage: theme.palette.backgroundImage.main\r\n    },\r\n    eventButtonHolder: {\r\n        display: \"flex\",\r\n        flexFlow: \"column\",\r\n        alignItems: \"center\",\r\n        justifyContent: \"space-between\",\r\n    },\r\n    eventContent: {\r\n        margin: 0,\r\n        flexGrow: 1,\r\n        resize: \"none\",\r\n        backgroundColor: theme.palette.background.paper,\r\n        color: theme.palette.text.primary,\r\n        border: 0,\r\n        borderRadius: 3\r\n    },\r\n    eventButton: {\r\n        fontSize: 10,\r\n        margin: 2,\r\n    },\r\n    dateInput: {\r\n        width: \"max(calc(100% - 40px),)\",\r\n        margin: 10,\r\n    }\r\n}));\r\n\r\nfunction TimelineEventComponent(props) {\r\n    const classes = useStyles();\r\n    const [display, setDisplay] = React.useState(true);\r\n    return (\r\n        <Slide direction=\"right\" in={display} unmountOnExit={false} mountOnEnter={false}>\r\n            <div className={classes.eventContainer} id=\"timeline_event\">\r\n                <div className={classes.eventBar}>\r\n                    <TextField size=\"small\" label=\"Date\" margin=\"dense\" value={props.date} onChange={e => { props.updateEventDate(e.target.value) }} className={classes.dateInput}></TextField>\r\n                    <div className={classes.eventButtonHolder}>\r\n                        <Button variant=\"contained\" size=\"small\" color=\"primary\" onClick={() => { props.clearEntry(); }} className={classes.eventButton}>Clear</Button>\r\n                        <Button variant=\"contained\" size=\"small\" color=\"secondary\" onClick={() => { props.deleteEntry(props.activeEntry); }} disabled={props.oneEntryLeft} className={classes.eventButton}>Delete</Button>\r\n                        {/*Delete button is disabled for the first entry TODO: because for now we haven't implemented the add entry before first element functionality yet, nor is there a button for it*/}\r\n                    </div>\r\n                </div>\r\n                <textarea className={classes.eventContent} value={props.event} onChange={e => { props.updateEvent(e.target.value) }} multiline=\"true\"></textarea>\r\n                <RetractButton direction=\"left\" top={\"50%\"} left={\"calc(100% + 6px)\"} checked={display} onClick={() => setDisplay(!display)} />\r\n            </div>\r\n        </Slide>\r\n    );\r\n}\r\n\r\nexport default React.memo(TimelineEventComponent);","// Import React\r\nimport React from \"react\";\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Slide from '@material-ui/core/Slide';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport PlayIcon from '@material-ui/icons/PlayArrow';\r\nimport PauseIcon from '@material-ui/icons/Pause';\r\nimport StopIcon from '@material-ui/icons/Stop';\r\n\r\n// Import retract button custom component\r\nimport RetractButton from './RetractButton.js';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    playToolbarContainer: {\r\n        position: \"absolute\",\r\n        left: 0,\r\n        bottom: 723, // This value should be such that the play toolbar lie just above the event box\r\n        width: 20,\r\n        height: 65,\r\n        zIndex: 1,\r\n        display: \"flex\",\r\n        justifyContent: \"center\",\r\n        flexFlow: \"column\",\r\n        padding: 5,\r\n        borderRightStyle: \"ridge\",\r\n        borderTopStyle: \"ridge\",\r\n        borderBottomStyle: \"ridge\",\r\n        borderColor: theme.palette.border,\r\n        backgroundImage: theme.palette.backgroundImage.main,\r\n        WebkitBorderImage: theme.palette.borderImage\r\n    },\r\n    playToolbarButton: {\r\n        fontSize: 16,\r\n        margin: 0,\r\n        padding: 0,\r\n    }\r\n}));\r\n\r\nfunction PlayToolbarComponent(props) {\r\n    const classes = useStyles();\r\n    const [display, setDisplay] = React.useState(true);\r\n    return (\r\n        <Slide direction=\"right\" in={display} unmountOnExit={false} mountOnEnter={false}>\r\n            <div className={classes.playToolbarContainer} id=\"playToolbar\">\r\n                <IconButton\r\n                    className={classes.playToolbarButton}\r\n                    onClick={() => {\r\n                        props.updatePlaying(!props.playing, () => {\r\n                            if (props.playing) {\r\n                                props.pausePlaying();\r\n                            } else {\r\n                                props.playTimeline();\r\n                            }\r\n                        })\r\n                    }}\r\n                >\r\n                    {props.playing ? (\r\n                        <PauseIcon/>\r\n                    ): (\r\n                        <PlayIcon/>\r\n                    )}\r\n                </IconButton>\r\n                <IconButton\r\n                    className={classes.playToolbarButton}\r\n                    onClick={() => {\r\n                        props.stopPlaying();\r\n                    }}\r\n                >\r\n                    <StopIcon/>\r\n                </IconButton>\r\n                <IconButton\r\n                    className={classes.playToolbarButton}\r\n                    onClick={() => {\r\n                        props.changePlaySpeed();\r\n                    }}\r\n                >\r\n                    {props.playSpeed + \"x\"}\r\n                </IconButton>\r\n                <RetractButton direction=\"left\" top={\"50%\"} left={36} checked={display} onClick={() => setDisplay(!display)} />\r\n            </div>\r\n        </Slide>\r\n    );\r\n}\r\n\r\nexport default React.memo(PlayToolbarComponent);","import { makeStyles } from '@material-ui/core/styles';\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport IconButton from '@material-ui/core/IconButton';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    addIconButtonContainerCondensedTimeline: {\r\n        position: \"absolute\",\r\n        left: 78,\r\n        bottom: -11,\r\n        padding: 0,\r\n        zIndex: 1,\r\n        transform: \"scale(0.8)\"\r\n    },\r\n    addIconButtonCondensedTimeline: {\r\n        padding: 0,\r\n        zIndex: 2,\r\n        color: theme.palette.text.secondary,\r\n    },\r\n}));\r\n\r\nexport default function CondensedTimelineAddButton(props) {\r\n    const classes = useStyles();\r\n    return (\r\n        <td>\r\n            <div className={classes.addIconButtonContainerCondensedTimeline}>\r\n                <IconButton size=\"small\" className={classes.addIconButtonCondensedTimeline} onClick={(e) => { props.addEntry(props.index + 1); e.stopPropagation();}}>\r\n                    {/*This is the fake button for visuals only*/}\r\n                    <AddIcon></AddIcon>\r\n                </IconButton>\r\n            </div>\r\n        </td>\r\n    );\r\n}","import { makeStyles } from '@material-ui/core/styles';\r\nimport ClearIcon from '@material-ui/icons/Clear';\r\nimport IconButton from '@material-ui/core/IconButton';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    deleteIconButtonContainerCondensedTimeline: {\r\n        position: \"absolute\",\r\n        right: 0,\r\n        bottom: 0,\r\n        padding: 0,\r\n        zIndex: 1,\r\n        transform: \"scale(0.8)\"\r\n    },\r\n    deleteIconButtonCondensedTimeline: {\r\n        padding: 0,\r\n        zIndex: 2,\r\n        color: theme.palette.text.secondary,\r\n    },\r\n}));\r\n\r\nexport default function CondensedTimelineDeleteButton(props) {\r\n    const classes = useStyles();\r\n    return (\r\n        <td>\r\n            <div className={classes.deleteIconButtonContainerCondensedTimeline}>\r\n                <IconButton size=\"small\" className={classes.deleteIconButtonCondensedTimeline} disabled={props.disabled} onClick={(e) => { props.deleteEntry(props.index); e.stopPropagation();}}>\r\n                    {/*This is the fake button for visuals only*/}\r\n                    <ClearIcon></ClearIcon>\r\n                </IconButton>\r\n            </div>\r\n        </td>\r\n    );\r\n}","// Import React\r\nimport React from \"react\";\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Slide from '@material-ui/core/Slide';\r\nimport Scrollbars from 'react-custom-scrollbars';\r\nimport Table from '@material-ui/core/Table';\r\nimport TableBody from '@material-ui/core/TableBody';\r\nimport TableCell from '@material-ui/core/TableCell';\r\nimport TableContainer from '@material-ui/core/TableContainer';\r\nimport TableHead from '@material-ui/core/TableHead';\r\nimport TableRow from '@material-ui/core/TableRow';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport CondensedTimelineAddButton from \"./CondensedTimelineAddButton.js\";\r\nimport CondensedTimelineDeleteButton from \"./CondensedTimelineDeleteButton.js\"\r\n\r\n// Import retract button custom component\r\nimport RetractButton from './RetractButton.js';\r\nimport { CallReceived } from \"@material-ui/icons\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    condensedTimelineContainer: {\r\n      position: \"absolute\",\r\n      left: 0,\r\n      bottom: 309, // This value should be such that the event box touches the play bar\r\n      minWidth: 140,\r\n      width: \"20%\",\r\n      height: 400,\r\n      zIndex: 1,\r\n      display: \"flex\",\r\n      flexFlow: \"column\",\r\n      alignItems: \"stretch\",\r\n      padding: 5,\r\n      borderRightStyle: \"ridge\",\r\n      borderTopStyle: \"ridge\",\r\n      borderBottomStyle: \"ridge\",\r\n      borderColor: theme.palette.border,\r\n      backgroundImage: theme.palette.backgroundImage.main,\r\n      WebkitBorderImage: theme.palette.borderImage,\r\n    },\r\n    tableHeading: {\r\n      fontSize: 14,\r\n      overflowWrap: \"break-word\",\r\n      hyphens: \"auto\",\r\n      padding: 5,\r\n    },\r\n    tableCell: {\r\n      fontSize: 10,\r\n      overflowWrap: \"anywhere\",\r\n      padding: 5,\r\n    },\r\n    dateColumn: {\r\n      width: 80,\r\n    },\r\n    eventColumn: {\r\n    },\r\n    notCurrentTableEntry: {\r\n      opacity: 1,\r\n      border: 7,\r\n      borderLeftStyle: \"none\",\r\n    },\r\n    currentTableEntry: {\r\n      border: 7,\r\n      borderColor: theme.palette.tableRowFocusColor,\r\n      borderLeftStyle: \"solid\",\r\n    },\r\n    tableEntry: {\r\n      position: \"relative\",\r\n      height: 25,\r\n    },\r\n    tableEnd: {\r\n      position: \"relative\",\r\n      height: 10,\r\n    }\r\n}));\r\n\r\nfunction CondensedTimelineComponent(props) {\r\n    const classes = useStyles();\r\n    const [display, setDisplay] = React.useState(true);\r\n\r\n    return (\r\n        <Slide direction=\"right\" in={display} unmountOnExit={false} mountOnEnter={false}>\r\n            <div className={classes.condensedTimelineContainer} id=\"condensed_timeline\">\r\n              <Scrollbars>\r\n                <TableContainer component={Paper}>\r\n                  <Table size=\"small\" aria-label=\"a dense table\">\r\n                    <TableHead>\r\n                      <TableRow key={\"table_head\"}>\r\n                        <TableCell key={\"date_cell_head\"} className={classes.tableHeading + ' ' + classes.dateColumn}>Date</TableCell>\r\n                        <TableCell key={\"event_cell_head\"} className={classes.tableHeading + ' ' + classes.eventColumn} align=\"left\">Event</TableCell>\r\n                      </TableRow>\r\n                    </TableHead>\r\n                    <TableBody>\r\n                      {props.scenarioData.map((entry, index) => (\r\n                        <TableRow\r\n                          id={\"table_row_\" + index}\r\n                          key={\"table_row_\" + index}\r\n                          className={\r\n                            classes.tableEntry + \" \" +\r\n                            (index === props.activeEntry ? classes.currentTableEntry : classes.notCurrentTableEntry)\r\n                          }\r\n                          hover={true}\r\n                          onClick={() => {props.updateActiveEntry(index)}}\r\n                        >\r\n                          <TableCell key={\"date_cell_\" + index} className={classes.tableCell + ' ' + classes.dateColumn}>\r\n                            {entry.date}\r\n                          </TableCell>\r\n                          <TableCell key={\"event_cell_\" + index} className={classes.tableCell + ' ' + classes.eventColumn} align=\"left\">\r\n                            {entry.event}\r\n                          </TableCell>\r\n                          <CondensedTimelineDeleteButton themeDict={props.themeDict} deleteEntry={props.deleteEntry} index={index} disabled={props.oneEntryLeft}/>\r\n                          <CondensedTimelineAddButton themeDict={props.themeDict} addEntry={props.addEntry} index={index}/>\r\n                        </TableRow>\r\n                      ))}\r\n                      <TableRow key={\"table_end\"} className={classes.tableEnd}>\r\n                          <TableCell key={\"date_cell_table_end\"}/>\r\n                          <TableCell key={\"event_cell_table_end\"}/>\r\n                      </TableRow>\r\n                    </TableBody>\r\n                  </Table>\r\n                </TableContainer>\r\n              </Scrollbars>\r\n              <RetractButton direction=\"left\" top={\"50%\"} left={\"calc(100% + 6px)\"} checked={display} onClick={() => setDisplay(!display)} />\r\n            </div>\r\n        </Slide>\r\n    );\r\n}\r\n\r\nexport default React.memo(CondensedTimelineComponent);","export default __webpack_public_path__ + \"static/media/MarbleTexture.1cb26e16.jpg\";","export default __webpack_public_path__ + \"static/media/GoldTexture.302ee534.png\";","import MarbleTexture from '../assets/img/MarbleTexture.jpg';\r\nimport GoldTexture from '../assets/img/GoldTexture.png';\r\n\r\n// Colors should be given in hex\r\nconst themeDict = {\r\n    material: { // Theme object for material ui theming component FIXME: add corresponding use themeprovider thing to the app js\r\n        palette: {\r\n            type: \"dark\",\r\n            secondary: {\r\n                main: \"#d50000\",\r\n                light: \"#ff5131\",\r\n                dark: \"#9b0000\"\r\n            },\r\n            border: \"#d4af37\",\r\n            borderImage: `url(${GoldTexture}) 30`,\r\n            background: {\r\n                light: \"#F5F5F5\",\r\n            },\r\n            backgroundImage: {\r\n                main: `url(${MarbleTexture})`,\r\n            },\r\n            tableRowFocusColor: \"#F5F5F5\",\r\n        },\r\n    },\r\n    other: { // Theme object for map to use, this is passed down as props to all child\r\n        polyStrokeColor: \"#36454F\",\r\n        polyStrokeWeight: 0.5,\r\n        polyFillColorDefault: \"#DCDCDC\",\r\n        polyFillOpacityDefault: 0.2,\r\n        polyFillOpacityColored: 0.6,\r\n        polyFillOpacityHovered: 0.9,\r\n        timelineMarkerSpacing: 120,\r\n        timelineMarkerLabelWidth: 100,\r\n        markerSize: 30,\r\n    }\r\n\r\n}\r\n\r\nexport default themeDict;","// Given geoJson with features (here assume regions, i.e. polygons/multipolygons) each with properties regionID and color and label\r\n// Generate a js object with keys as the regionID and value as object of the properties of the regions\r\nexport default function createRegionDict(geoJson) {\r\n    let retval = {};\r\n    geoJson.features.forEach(region => {\r\n        retval[region.properties.regionID] = { // TODO: get rid of object, change code elsewhre as well so it only has the value color, no need to object\r\n            color: null, // expects a hex string, or if null takes the default fill color as specified in theme\r\n        };\r\n    });\r\n    return retval;\r\n}","import React from 'react';\r\n\r\nconst steps = [\r\n    {\r\n        target: 'body',\r\n        content: \r\n        <React.Fragment>\r\n            <p>***IF YOU CAN'T SEE THE SKIP BUTTON: TRY ZOOMING OUT (e.g. CTRL + SCROLL)***</p>\r\n            <p>Welcome to Making History Sandbox! Click NEXT for the tutorial or SKIP to close the tutorial.</p>\r\n            <hr/>\r\n            <p>***NEW FEATURES*** September, 2022</p>\r\n            <p>Condensed timeline view (on left of page): Can be used to navigate the timeline by clocking on entries and add new events, albeit cannot edit events/dates here.</p>\r\n            <p>Play timeline toolbar (on the left of the page): Currently offers 1x to 16x speeds, where 1x corresponds to ~2s per time point</p>\r\n            <hr/>\r\n            <p>FAQs:</p>\r\n            <p>Changing color of regions of same color: toggle \"Same\" button, then color as usual</p>\r\n            <p>Removing borders: set region border width to 0 in theme panel on the right</p>\r\n            <p>Adding markers with tooltips: use marker box on side panel; added markers can be dragged and clicked to reveal/edit tooltip</p>\r\n            <p>Custom geoJSON saves don't load: load them using CustomGeoJSON panel (saves too), not the load button</p>\r\n            <hr/>\r\n            <p>Making custom regions: <a href=\"https://github.com/Yulin-W/making-history-sandbox/blob/main/customRegionTutorial.md\" target=\"_blank\">Custom Region Tutorial</a></p>\r\n            <hr/>\r\n            <p>See acknowledgements at the end of the tutorial</p>\r\n            <p>Disclaimer: Making History Sandbox (application) is not intended to be historically accurate nor do they represent personal views of the author. The application is provided without any warranty of any kind whatsoever, either express or implied.</p>\r\n            <hr/>\r\n            <p>Feedback/Suggestions</p>\r\n            <p>Please open an issue on <a href=\"https://github.com/Yulin-W/making-history-sandbox\">Github</a> or email me at Yulin-W@outlook.com</p>\r\n            <p>Note: I am not actively developing this anymore. I will try but cannot guarantee timely updates/fixes/reply to feedback.</p>\r\n        </React.Fragment>,\r\n        placement: 'center'\r\n    },\r\n    {\r\n        target: '#colorbar',\r\n        content: 'Choose color to color with via various methods provided, e.g. slider, RGB. Displays legend label for selected color that can be edited here (alternatively edit in legend panel).'\r\n    },\r\n    {\r\n        target: '#toolbar',\r\n        content: 'Use erase for removing colors, same for coloring (or erasing if erase button on) regions with same color, lasso for colouring (or erasing if erase button on) selected regions, and pick for picking color of a region as current color.'\r\n    },\r\n    {\r\n        target: '#map',\r\n        content: 'This is the map. To color/erase, click the region. Or, if lasso is used, click and hold to select regions.',\r\n    },\r\n    {\r\n        target: '.leaflet-control-layers',\r\n        content: 'This is where you change the background map and switch on/off the regions/markers.'\r\n    },\r\n    {\r\n        target: '#timeline_bar',\r\n        content: 'This is the timeline. To add a timepoint, click the + in intended position. The added timepoint will inherit the region colors of the preceding timepoint. To go to a timepoint, click on it.',\r\n    },\r\n    {\r\n        target: '#timeline_event',\r\n        content: 'This is where you edit the date label and event description of the timepoint. Clear empties the date/event entry (not the map colors though). Delete removes the current timepoint.',\r\n    },\r\n    {\r\n        target: '#condensed_timeline',\r\n        content: 'This is a condensed view of the timeline. You can also navigate to events by clicking them here. Adding and deleting events can also be done (using +, x buttons). Albeit editing cannot be done here.',\r\n    },\r\n    {\r\n        target: '#plugin_menu',\r\n        content: \"This is where additional functionalities are, including legend, premade scenarios, map theme editing (e.g. borders), loading custom region file/save, etc. For custom region tutorial see https://github.com/Yulin-W/making-history-sandbox/blob/main/customRegionTutorial.md\",\r\n    },\r\n    {\r\n        target: '#menu',\r\n        content: 'This is the menu bar. I guess there is not much to say.'\r\n    },\r\n    {\r\n        target: 'body',\r\n        content: <React.Fragment>\r\n            <p>Acknowledgements</p>\r\n            <p>\"mapAdmin.json\" (geojson basemap for the regions) was modified from: Natural Earth. Free vector and raster map data @ naturalearthdata.com.</p>\r\n            <p>Community contributed scenarios: Thanks to the following members of the community for these scenarios:</p>\r\n            <p>2021 Modern Map, by DawnbreakZ</p>\r\n        </React.Fragment>,\r\n        placement: 'center'\r\n    }\r\n]\r\nexport default steps;","// Import React and other modules\r\nimport React from \"react\";\r\nimport { createMuiTheme, ThemeProvider, withStyles } from '@material-ui/core/styles';\r\n\r\n// Import css\r\nimport './App.css';\r\n\r\n// Import custom components\r\nimport MenuComponent from \"./components/MenuComponent.js\";\r\nimport MapComponent from './components/MapComponent.js';\r\nimport ColorBarComponent from './components/ColorBarComponent.js';\r\nimport ToolbarComponent from \"./components/ToolbarComponent.js\";\r\nimport PluginMenuComponent from \"./components/PluginMenuComponent.js\";\r\nimport TimelineBarComponent from './components/TimelineBarComponent.js';\r\nimport TimelineEventComponent from './components/TimelineEventComponent.js';\r\nimport PlayToolbarComponent from './components/PlayToolbarComponent.js';\r\nimport CondensedTimelineComponent from './components/CondensedTimelineComponent';\r\n\r\n// Import default themeDict\r\nimport themeDict from './themes/default';\r\n\r\n// Import default basemap geojson\r\nimport mapAdmin from \"./assets/basemap/mapAdmin.json\"; // This is the only default map for the app\r\n\r\n// Import scripts\r\nimport createRegionDict from './scripts/createRegionDict.js';\r\nimport createScenarioEntry from './scripts/createScenarioEntry.js';\r\nimport saveScenario from './scripts/saveScenario.js';\r\nimport nextNumInList from './scripts/nextNumInList';\r\n\r\n// Import plugins\r\nimport plugins from \"./appPlugins.js\";\r\n\r\n// Import deep clone\r\nimport cloneDeep from \"clone-deep\";\r\n\r\n// Import react-joyride\r\nimport ReactJoyride, { EVENTS } from 'react-joyride';\r\nimport steps from './assets/other/joyrideSteps.js';\r\n\r\n// Import Google Analytics\r\nimport ReactGA from 'react-ga';\r\n\r\n// Setup Google Analytics\r\nReactGA.initialize(\"UA-176706567-4\");\r\nReactGA.pageview(window.location.pathname + window.location.search);\r\n\r\nconst theme = createMuiTheme(themeDict.material);\r\n\r\nconst useStyles = theme => ({\r\n});\r\n\r\nclass App extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    // Declare some constant attributes\r\n    this.baseMap = mapAdmin;\r\n    this.mapKey = \"mapAdmin\";\r\n    this.themeDictDefault = themeDict;\r\n\r\n    // Convert baseMap to a prototype, const dictionary indexed by regionID\r\n    this.regionDictDefault = createRegionDict(this.baseMap);\r\n    this.scenarioDataDefault = [\r\n      createScenarioEntry(this.regionDictDefault, \"2000 January 1\", \"An Event\"), // Default is 2 entry with the default regionDict, empty date and event entry\r\n      createScenarioEntry(this.regionDictDefault, \"2010 January 1\", \"Another Event\"),\r\n    ];\r\n\r\n    this.plugins = plugins;\r\n    // Default values should ideally all be based off the scenarioDataDefault\r\n    // Setup default state values\r\n    let pluginData = {};\r\n    for (const [name, entry] of Object.entries(this.plugins)) {\r\n      pluginData[name] = entry.initState(this.scenarioDataDefault);\r\n    }\r\n\r\n    let colorData = [];\r\n    let i;\r\n    for (i = 0; i < this.scenarioDataDefault.length; i++) {\r\n      colorData.push({});\r\n    }\r\n\r\n    // Set initial state\r\n    this.state = {\r\n      themeDict: this.themeDictDefault,\r\n      scenarioData: this.scenarioDataDefault, // Array of information for the scenarios\r\n      pluginData: pluginData, // Create object for data in plugin indexed by name of plugin\r\n      colorData: colorData, // Dictionary with corresponding entries to scenarioData, that records the number of regions of specific color for the scenario timeline entry\r\n      activeEntry: 0, // index of currently active on map entry in scenarioData\r\n      lassoSelecting: false, // state for whether lasso select tool is activated\r\n      erasing: false, // state for whether eraser tool is activated\r\n      same: false, // state for whether same tool is activated\r\n      helpOn: true, // On opening app, defaults to have help on\r\n      picking: false, // color picking tool defaults to not on\r\n      mapKey: this.mapKey, // This is here both as a state and to act as a trigger for MapComponent and App overall to rerender upon loading in a new GeoJSON, it should only be modified by CustomGeoJSONLoaderPlugin\r\n      playing: false, // defaults to not playing time line on opening app\r\n      playSpeed: 1, // defaults to 1x play speed\r\n    };\r\n\r\n    // Numerous refs\r\n    this.colorBarRef = React.createRef(null);\r\n    this.mapRef = React.createRef(null);\r\n\r\n    // Bind this to methods\r\n    this.getColor = this.getColor.bind(this);\r\n    this.assignRegions = this.assignRegions.bind(this);\r\n    this.updateActiveEntry = this.updateActiveEntry.bind(this);\r\n    this.addEntry = this.addEntry.bind(this);\r\n    this.updateEventDate = this.updateEventDate.bind(this);\r\n    this.updateEvent = this.updateEvent.bind(this);\r\n    this.deleteEntry = this.deleteEntry.bind(this);\r\n    this.updatePluginData = this.updatePluginData.bind(this);\r\n    this.updateMultiPluginData = this.updateMultiPluginData.bind(this);\r\n    this.clearEntry = this.clearEntry.bind(this);\r\n    this.loadSave = this.loadSave.bind(this);\r\n    this.updateLassoSelecting = this.updateLassoSelecting.bind(this);\r\n    this.updateErasing = this.updateErasing.bind(this);\r\n    this.setColorBarColor = this.setColorBarColor.bind(this);\r\n    this.processRegionHoveredOn = this.processRegionHoveredOn.bind(this);\r\n    this.processRegionHoveredOut = this.processRegionHoveredOut.bind(this);\r\n    this.save = this.save.bind(this);\r\n    this.getRegionColorByIndex = this.getRegionColorByIndex.bind(this);\r\n    this.updatePicking = this.updatePicking.bind(this);\r\n    this.resetAppBasedOnBasemap = this.resetAppBasedOnBasemap.bind(this);\r\n    this.runPluginFunc = this.runPluginFunc.bind(this)\r\n    this.handleJoyrideCallback = this.handleJoyrideCallback.bind(this);\r\n    this.updateMarkerData = this.updateMarkerData.bind(this);\r\n    this.getMarkerData = this.getMarkerData.bind(this);\r\n    this.initUndefinedPluginData = this.initUndefinedPluginData.bind(this);\r\n    this.updateSame = this.updateSame.bind(this);\r\n    this.assignSameColor = this.assignSameColor.bind(this);\r\n    this.getColorLabel = this.getColorLabel.bind(this);\r\n    this.refreshColorBarInfo = this.refreshColorBarInfo.bind(this);\r\n    this.updateLegendLabel = this.updateLegendLabel.bind(this);\r\n    this.updatePlaying = this.updatePlaying.bind(this);\r\n    this.playTimeline = this.playTimeline.bind(this);\r\n    this.stopPlaying = this.stopPlaying.bind(this);\r\n    this.changePlaySpeed = this.changePlaySpeed.bind(this);\r\n    this.pausePlaying = this.pausePlaying.bind(this);\r\n  }\r\n\r\n  // Returns pluginData for marker of current activeEntry\r\n  getMarkerData() {\r\n    return this.state.pluginData[\"Marker\"][this.state.activeEntry];\r\n  }\r\n\r\n  // Updates pluginData for marker update of current activeEntry\r\n  updateMarkerData(markerData) {\r\n    let currentData = cloneDeep(this.state.pluginData[\"Marker\"]);\r\n    currentData[this.state.activeEntry] = markerData;\r\n    this.updatePluginData(\"Marker\", currentData);\r\n  }\r\n\r\n  // Runs functions entry in plugin of specified key, supplies the args to the function called in addition to the this argument, and also returns a list of the return values of the functions that did return values\r\n  runPluginFunc(key, args) {\r\n    let retval = {};\r\n    Object.entries(this.plugins).forEach(entry => {\r\n      if (key in entry[1].functions) {\r\n        const val = entry[1].functions[key](this, ...args);\r\n        if (val) {\r\n          retval[entry[0]] = val;\r\n        }\r\n      }\r\n    });\r\n    return retval;\r\n  }\r\n\r\n  // Resets app based on basemap, in particular the key states, including scenariodata, colorData, pluginData\r\n  resetAppBasedOnBasemap(baseMap, mapKey, callback = null) {\r\n    // This part is the same as from the app constructor TODO: try to alter so to promode code reuse\r\n    this.baseMap = baseMap;\r\n    this.mapKey = mapKey;\r\n    // Some attributes for plugins to use\r\n    // Convert baseMap to a prototype, const dictionary indexed by regionID\r\n    this.regionDictDefault = createRegionDict(this.baseMap);\r\n    this.scenarioDataDefault = [\r\n      createScenarioEntry(this.regionDictDefault, \"2000 January 1\", \"An Event\"), // Default is 2 entry with the default regionDict, empty date and event entry\r\n      createScenarioEntry(this.regionDictDefault, \"2010 January 1\", \"Another Event\"),\r\n    ];\r\n\r\n    this.plugins = plugins;\r\n    // Default values should ideally all be based off the scenarioDataDefault\r\n    // Setup default state values\r\n    let pluginData = {};\r\n    for (const [name, entry] of Object.entries(this.plugins)) {\r\n      pluginData[name] = entry.initState(this.scenarioDataDefault);\r\n    }\r\n\r\n    let colorData = [];\r\n    let i;\r\n    for (i = 0; i < this.scenarioDataDefault.length; i++) {\r\n      colorData.push({});\r\n    }\r\n\r\n    // This part is the same as the state setting, but here we use setState instead of directly setting, only difference is that helpOn here is not switched on as users would have seen it already\r\n    this.setState({\r\n      // Themedict is not reset to default, the existing themeDict settings will continue to be used\r\n      scenarioData: this.scenarioDataDefault,\r\n      pluginData: pluginData,\r\n      colorData: colorData,\r\n      activeEntry: 0,\r\n      lassoSelecting: false,\r\n      erasing: false,\r\n      same: false,\r\n      helpOn: false, // This is different from the initial initialization state value\r\n      picking: false,\r\n      mapKey: this.mapKey,\r\n      playing: false,\r\n      playSpeed: 1,\r\n    }, () => {\r\n      this.refreshColorBarInfo(); // Refresh color bar so that correct legend label is displayed\r\n      if (callback) {\r\n        callback();\r\n      }\r\n    })\r\n  }\r\n\r\n  // Update color picker state\r\n  updatePicking(newState, callback = null) {\r\n    this.setState({ picking: newState }, () => {\r\n      if (callback) {\r\n        callback();\r\n      }\r\n    });\r\n  }\r\n\r\n  processRegionHoveredOn(layer) {\r\n    // Running plugin methods\r\n    this.runPluginFunc(\"onProcessRegionHoveredOn\", [layer]);\r\n  }\r\n\r\n  processRegionHoveredOut(layer) {\r\n    // Running plugin methods\r\n    this.runPluginFunc(\"onProcessRegionHoveredOut\", [layer]);\r\n  }\r\n\r\n  // Updates plugin data for the specified plugin with the specified data, the key should be the one used in the plugins dictionary\r\n  updatePluginData(key, data, callback=null) {\r\n    let currentData = cloneDeep(this.state.pluginData);\r\n    currentData[key] = data;\r\n    this.setState({ pluginData: currentData }, () => {\r\n      // Refresh color bar info if the updated pluginData is for legend so that correct legend labels are displayed\r\n      if (key === \"Legend\") {\r\n        this.refreshColorBarInfo();\r\n      }\r\n      if (callback) {\r\n        callback();\r\n      }\r\n    });\r\n  }\r\n\r\n  // This is needed to prevent bugs occurring when multiple plugin data updates are called close to each other and resulting in state update not as fast as one would wish\r\n  updateMultiPluginData(dataDict, callback=null) {\r\n    let currentData = cloneDeep(this.state.pluginData);\r\n    for (const [key, data] of Object.entries(dataDict)) {\r\n      currentData[key] = data;\r\n    }\r\n    this.setState({ pluginData: currentData }, () => {\r\n      // Refresh color bar info so that correct legend labels are displayed\r\n      if (\"Legend\" in dataDict) {\r\n        this.refreshColorBarInfo();\r\n      }\r\n      if (callback) {\r\n        callback();\r\n      }\r\n    });\r\n  }\r\n\r\n  // Updates lasso selecting, expects true/false boolean value, then runs callback if any\r\n  updateLassoSelecting(newState, callback = null) {\r\n    this.setState({ lassoSelecting: newState }, () => {\r\n      if (callback) {\r\n        callback();\r\n      }\r\n    });\r\n  }\r\n\r\n  // Update eraser state, such state in turn determines the value getColor returns\r\n  updateErasing(newState, callback = null) {\r\n    this.setState({ erasing: newState }, () => {\r\n      if (callback) {\r\n        callback();\r\n      }\r\n    });\r\n  }\r\n\r\n  // Returns hex of currently selected color, as in the colorBarComponent; or null if erasing or erasing same mode is activated\r\n  getColor() {\r\n    if (this.state.erasing) { // This ensures that upon erase tool selected, clicking will erase label and color\r\n      return null;\r\n    } else {\r\n      return this.colorBarRef.current.state.color;\r\n    }\r\n  }\r\n\r\n  // Sets color in colorBarComponent, expects a hex string\r\n  setColorBarColor(color) {\r\n    this.colorBarRef.current.setState({ color: color, colorLabel: this.getColorLabel(color) });\r\n  }\r\n\r\n  // Adds entry in position at specified index in scenarioData and colorData, new entry has no date nor event\r\n  addEntry(index) {\r\n    let currentData = cloneDeep(this.state.scenarioData);\r\n    let currentColorData = cloneDeep(this.state.colorData);\r\n    let newRegionDict = null;\r\n    let newColorEntry = null;\r\n    if (index > 0) { // use the regionDict, color entry of the previous entry as the starting spot\r\n      newRegionDict = createScenarioEntry(currentData[index - 1].regionDict);\r\n      newColorEntry = cloneDeep(currentColorData[index - 1]);\r\n    } else { // use the default regionDict, color entry if we are to insert at the beginning, currently this is not possible as it seems to lead to a multi-rerender yet some code is not ran in app.render scenario, and I get a regionDict undefined thing which I have no idea why; in light of this, I didn't do the add entry button in front of the first entry\r\n      newRegionDict = createScenarioEntry(this.regionDictDefault);\r\n      newColorEntry = {};\r\n    }\r\n    currentData.splice(index, 0, newRegionDict);\r\n    currentColorData.splice(index, 0, newColorEntry);\r\n    this.setState({ scenarioData: currentData, colorData: currentColorData }, () => {\r\n      // Update the plugin data, then in call back update active entry to ensure order of execution\r\n      const retval = this.runPluginFunc(\"onAddEntry\", [index]);\r\n      this.updateMultiPluginData(retval, () => {this.updateActiveEntry(index);});\r\n    });\r\n  }\r\n\r\n  // Deletes entry in position at specified index in scenarioData and colorData\r\n  // NB: this only works for deleting the index that is currently the active entry due to a bug (which isn't a problem right now because i recoded where it is called (specifically main location of concern is in the condensed timeline call; where upon calling not necessarily on the particular entry) to always ensure is at the active entry before calling this method); rip life then. TODO:\r\n  // TODO: this part of code is highly repetitive and copy and pasted; pretty cooked \r\n  deleteEntry(index) {\r\n    const currentData = cloneDeep(this.state.scenarioData);\r\n    const currentColorData = cloneDeep(this.state.colorData);\r\n    currentData.splice(index, 1);\r\n    currentColorData.splice(index, 1);\r\n    if ((index === this.state.activeEntry) && (index === this.state.scenarioData.length - 1)) {\r\n      // Deleted entry is the current entry and the last entry\r\n      // Hence we need to change entry to be focused on\r\n      const newIndex = this.state.activeEntry - 1;\r\n      // To avoid possibly access invalid active entry values, we update the activeEntry first, then update the scenarioDict to delete the entry\r\n      this.updateActiveEntry(newIndex, () => {\r\n        this.setState({ scenarioData: currentData, colorData: currentColorData }, () => {\r\n          const retval = this.runPluginFunc(\"onDeleteEntry\", [index]);\r\n          this.updateMultiPluginData(retval);\r\n        });\r\n      }) // Note reset style is included in the updateActiveEntry function already\r\n    } else if ((index !== this.state.activeEntry) && (index === this.state.scenarioData.length - 1)) {\r\n      // Deleted entry is not the current entry and is the last entry\r\n      // Just delete entry\r\n      this.setState({ scenarioData: currentData, colorData: currentColorData }, () => {\r\n        const retval = this.runPluginFunc(\"onDeleteEntry\", [index]);\r\n        this.updateMultiPluginData(retval, () => {\r\n          this.mapRef.current.resetAllRegionStyle();\r\n        });\r\n      });\r\n    } else if ((index === this.state.activeEntry) && (index !== this.state.scenarioData.length - 1)) {\r\n      // Deleted entry is the current entry and not the last entry\r\n      // Just delete entry; the index remains the same will automatically mean change to what was originally after the deleted event\r\n      this.setState({ scenarioData: currentData, colorData: currentColorData }, () => {\r\n        const retval = this.runPluginFunc(\"onDeleteEntry\", [index]);\r\n        this.updateMultiPluginData(retval, () => {\r\n          this.mapRef.current.resetAllRegionStyle();\r\n        });\r\n      });\r\n    } else {\r\n      // Deleted entry is not the current entry and not the last entry\r\n      // If the deleted entry is after the current entry then all good; but if index is before then need to shift index down to keep on the same event\r\n      if (index > this.state.activeEntry) {\r\n        // Deleted index after current index\r\n        this.setState({ scenarioData: currentData, colorData: currentColorData }, () => {\r\n          const retval = this.runPluginFunc(\"onDeleteEntry\", [index]);\r\n          this.updateMultiPluginData(retval, () => {\r\n            this.mapRef.current.resetAllRegionStyle();\r\n          });\r\n        });\r\n      } else if (index < this.state.activeEntry) {\r\n        // Deleted index before current index\r\n        const newIndex = this.state.activeEntry - 1;\r\n        this.updateActiveEntry(newIndex, () => {\r\n          this.setState({ scenarioData: currentData, colorData: currentColorData }, () => {\r\n            const retval = this.runPluginFunc(\"onDeleteEntry\", [index]);\r\n            this.updateMultiPluginData(retval);\r\n          });\r\n        }) // Note reset style is included in the updateActiveEntry function already\r\n      } else {\r\n        // deleted entry is the current entry; this shouldn't happen for this case. So throw an error\r\n        throw \"Delete entry is current entry despite this if/else cases is intended for situation where that is not true\";\r\n      }\r\n    }\r\n\r\n    // Running plugin methods\r\n    // this.runPluginFunc(\"onDeleteEntry\", [index]);\r\n  }\r\n\r\n  // Updates event date for active entry, expects a string argument\r\n  updateEventDate(date) {\r\n    let currentData = cloneDeep(this.state.scenarioData);\r\n    currentData[this.state.activeEntry].date = date;\r\n    this.setState({ scenarioData: currentData });\r\n\r\n    // Running plugin methods\r\n    this.runPluginFunc(\"onUpdateEventDate\", [date]);\r\n  }\r\n\r\n  // Updates event description for active entry, expects a string argument\r\n  updateEvent(event) {\r\n    let currentData = cloneDeep(this.state.scenarioData);\r\n    currentData[this.state.activeEntry].event = event;\r\n    this.setState({ scenarioData: currentData });\r\n\r\n    // Running plugin methods\r\n    this.runPluginFunc(\"onUpdateEvent\", [event]);\r\n  }\r\n\r\n  // Clears date and event of the current active entry, not the map though\r\n  clearEntry() {\r\n    let currentData = cloneDeep(this.state.scenarioData);\r\n    currentData[this.state.activeEntry].event = \"\";\r\n    currentData[this.state.activeEntry].date = \"\";\r\n    this.setState({ scenarioData: currentData });\r\n  }\r\n\r\n  // Updates index for active entry\r\n  updateActiveEntry(newIndex, callback = null) {\r\n    this.setState(\r\n      { activeEntry: newIndex },\r\n      () => {\r\n        document.getElementById(\"timeline_marker_\" + newIndex).scrollIntoView({block: 'nearest'});\r\n        document.getElementById(\"table_row_\" + newIndex).scrollIntoView({block: 'nearest'});\r\n        this.mapRef.current.resetAllRegionStyle();\r\n        this.runPluginFunc(\"onUpdateActiveEntry\", [newIndex]);\r\n        this.refreshColorBarInfo(); // Refresh color bar so that correct legend label is displayed\r\n        if (callback) { // runs callback if callback is not null\r\n          callback();\r\n        }\r\n      });\r\n  }\r\n\r\n  // Assigns regions of specified indices the currently selected color and update colorData accordingly, then run callback if any\r\n  assignRegions(indices, callback = null) {\r\n    const color = this.getColor();\r\n\r\n    // Modifying the new data before setting it as the state\r\n    let currentData = cloneDeep(this.state.scenarioData);\r\n    let currentColorData = cloneDeep(this.state.colorData);\r\n    let removedColors = [];\r\n    let addedColor = false;\r\n\r\n    indices.forEach(index => {\r\n      const previousColor = currentData[this.state.activeEntry].regionDict[index].color;\r\n      // Update for scenarioData the color of the region\r\n      currentData[this.state.activeEntry].regionDict[index].color = color;\r\n\r\n      // Only need to update if the previousColor is different from current color\r\n      if (previousColor !== color) {\r\n        // Deal with decrementing previous color's colorData entry, if any (no color means region not labelled/colored)\r\n        if (previousColor) {\r\n          currentColorData[this.state.activeEntry][previousColor] -= 1;\r\n          if (currentColorData[this.state.activeEntry][previousColor] === 0) {\r\n            // If the assigning took the count of regions of the color to 0, then remove it from the colorData\r\n            delete currentColorData[this.state.activeEntry][previousColor];\r\n            removedColors.push(previousColor);\r\n          }\r\n        }\r\n\r\n        // Deal with incrementing or creating entry for added color's colorData entry, if the color is not null (i.e. in erase mode)\r\n        if (color) {\r\n          if (color in currentColorData[this.state.activeEntry]) {\r\n            currentColorData[this.state.activeEntry][color] += 1;\r\n          } else {\r\n            currentColorData[this.state.activeEntry][color] = 1;\r\n            addedColor = true;\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    // Setting state, then do callback\r\n    this.setState({ scenarioData: currentData, colorData: currentColorData },\r\n      () => {\r\n        this.mapRef.current.resetSpecifiedRegionStyle(indices);\r\n        if (callback) {\r\n          callback();\r\n        }\r\n\r\n        // Running plugin methods\r\n        this.runPluginFunc(\"onAssignRegions\", [indices, color, removedColors, addedColor]);\r\n      });\r\n  }\r\n\r\n  // Saves the currently loaded scenario\r\n  save() {\r\n    saveScenario({\r\n      scenarioData: this.state.scenarioData,\r\n      colorData: this.state.colorData,\r\n      pluginData: this.state.pluginData,\r\n    });\r\n  }\r\n\r\n  // Filling undefined entries of pluginData to appropriate initialization states if necessary such that plugins may all function\r\n  initUndefinedPluginData(callback = null) {\r\n    let currentPluginData = cloneDeep(this.state.pluginData);\r\n    for (const [name, entry] of Object.entries(this.plugins)) {\r\n      if (!(name in currentPluginData)) {\r\n        currentPluginData[name] = entry.initState(this.state.scenarioData);\r\n      }\r\n    }\r\n    this.setState({ pluginData: currentPluginData }, () => {\r\n      this.refreshColorBarInfo(); // Refresh color bar so that correct legend label is displayed\r\n      if (callback) {\r\n        callback();\r\n      }\r\n    });\r\n  }\r\n\r\n  // Loads the specified save file containing scenarioData and pluginData, then sets current active entry to the first one, thereby resetting the region styling as well\r\n  loadSave(saveData) {\r\n    // Note we run update active entry first to avoid issues of current active entry being undefined after loading save\r\n    this.updateActiveEntry(0, () => {\r\n      this.setState({ scenarioData: saveData.scenarioData, colorData: saveData.colorData, pluginData: saveData.pluginData }, () => {\r\n        this.initUndefinedPluginData(() => this.updateActiveEntry(0));\r\n      });\r\n    })\r\n\r\n    // Running plugin methods\r\n    this.runPluginFunc(\"onLoadSave\", [saveData]);\r\n  }\r\n\r\n  // Refreshes color bar info so that legend label displayed corresponds to legend\r\n  refreshColorBarInfo() {\r\n    if (this.colorBarRef.current) { // Only resets upon legend change given the app has been loaded and the colorBar is loaded up\r\n      this.setColorBarColor(this.colorBarRef.current.state.color);\r\n    }\r\n  }\r\n\r\n  getRegionColorByIndex(index) {\r\n    // Return color hex, or null if that was the value\r\n    return this.state.scenarioData[this.state.activeEntry].regionDict[index].color;\r\n  }\r\n\r\n  // Function for controlling Joyride\r\n  handleJoyrideCallback(data) {\r\n    const { type } = data;\r\n    if (type === EVENTS.TOUR_END && this.state.helpOn) {\r\n      this.setState({ helpOn: false });\r\n    }\r\n  }\r\n\r\n  // Update same (button) state\r\n  updateSame(newState, callback = null) {\r\n    this.setState({ same: newState }, () => {\r\n      if (callback) {\r\n        callback();\r\n      }\r\n    });\r\n  }\r\n\r\n  // Assign all regions with the specified color hex. Note if new color not already on map, then it will be assigned with a new default label as opposed to existing label\r\n  assignSameColor(colorID) {\r\n    // First find indices of regions with the specified colorID\r\n    const currentEntryRegionDict = this.state.scenarioData[this.state.activeEntry].regionDict;\r\n    let indices = [];\r\n    for (const [regionID, regionData] of Object.entries(currentEntryRegionDict)) {\r\n      if (regionData.color === colorID) {\r\n        indices.push(regionID);\r\n      }\r\n    }\r\n\r\n    // Now run assign region (which will either assign color or erase depending on if erase is also activated)\r\n    this.assignRegions(indices);\r\n  }\r\n\r\n  // Returns label for the color if it is on the map, else return null\r\n  getColorLabel(colorID) {\r\n    if (colorID in this.state.pluginData[\"Legend\"][this.state.activeEntry]) {\r\n      return this.state.pluginData[\"Legend\"][this.state.activeEntry][colorID];\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  // Updates particular label in legend\r\n  updateLegendLabel(color, label) {\r\n    let currentLegendData = cloneDeep(this.state.pluginData[\"Legend\"]);\r\n    currentLegendData[this.state.activeEntry][color] = label;\r\n    this.updatePluginData(\"Legend\", currentLegendData);\r\n  }\r\n\r\n  // Updates status of playing\r\n  updatePlaying(newState, callback = null) {\r\n    this.setState({ playing: newState }, () => {\r\n      if (callback) {\r\n        callback();\r\n      }\r\n    });\r\n  }\r\n\r\n  // Plays timeline\r\n  async playTimeline() {\r\n    while (this.state.playing) {\r\n      const newEntry = this.state.activeEntry + 1;\r\n      if (newEntry === this.state.scenarioData.length) {\r\n        // Stop playing if next entry is the beyond end of timeline, i.e. reached end of timeline already\r\n        this.updatePlaying(false);\r\n      } else {\r\n        // Move to next entry\r\n        this.updateActiveEntry(newEntry)\r\n      }\r\n      await new Promise(r => setTimeout(r, 2000 / this.state.playSpeed)); // base speed is 2s\r\n    }\r\n  }\r\n\r\n  // Pauses playing timeline\r\n  pausePlaying() {\r\n    this.updatePlaying(false);\r\n  }\r\n\r\n  // Stops playing timeline and goes back to start\r\n  stopPlaying() {\r\n    this.updatePlaying(false, () => {\r\n      this.updateActiveEntry(0)\r\n    });\r\n  }\r\n\r\n  // Change timeline play speed\r\n  changePlaySpeed() {\r\n    const playSpeedArray = [1,2,4,8,16];\r\n    const newSpeed = nextNumInList(this.state.playSpeed, playSpeedArray);\r\n    this.setState({ playSpeed: newSpeed });\r\n  }\r\n\r\n  render() {\r\n    const { classes } = this.props;\r\n    return (\r\n      <ThemeProvider theme={theme}>\r\n        <div className=\"App\">\r\n          <ReactJoyride\r\n            callback={this.handleJoyrideCallback}\r\n            steps={steps}\r\n            continuous\r\n            disableOverlayClose\r\n            disableCloseOnEsc\r\n            showProgress\r\n            showSkipButton\r\n            run={this.state.helpOn}\r\n            styles={{\r\n              buttonClose: {\r\n                display: \"none\",\r\n              },\r\n              buttonSkip: {\r\n                backgroundColor: theme.palette.secondary.main,\r\n                color: theme.palette.text.primary,\r\n                fontSize: 20,\r\n              },\r\n            }}\r\n          />\r\n          <MenuComponent\r\n            save={this.save}\r\n            loadSave={this.loadSave}\r\n            openHelp={() => { this.setState({ helpOn: true }); }}\r\n          />\r\n          <ToolbarComponent\r\n            lassoSelecting={this.state.lassoSelecting}\r\n            updateLassoSelecting={this.updateLassoSelecting}\r\n            erasing={this.state.erasing}\r\n            updateErasing={this.updateErasing}\r\n            picking={this.state.picking}\r\n            updatePicking={this.updatePicking}\r\n            updateSame = {this.updateSame}\r\n            same={this.state.same}\r\n          />\r\n          <PluginMenuComponent app={this} />\r\n          <TimelineBarComponent\r\n            updateActiveEntry={this.updateActiveEntry}\r\n            activeEntry={this.state.activeEntry}\r\n            scenarioData={this.state.scenarioData}\r\n            addEntry={this.addEntry}\r\n            themeDict={this.state.themeDict.other}\r\n          />\r\n          <TimelineEventComponent\r\n            date={this.state.scenarioData[this.state.activeEntry].date}\r\n            event={this.state.scenarioData[this.state.activeEntry].event}\r\n            updateEventDate={this.updateEventDate}\r\n            updateEvent={this.updateEvent}\r\n            deleteEntry={this.deleteEntry}\r\n            activeEntry={this.state.activeEntry}\r\n            clearEntry={this.clearEntry}\r\n            oneEntryLeft={this.state.scenarioData.length === 1}\r\n            themeDict={this.state.themeDict.other}\r\n          />\r\n          <CondensedTimelineComponent\r\n            themeDict={this.state.themeDict.other}\r\n            scenarioData={this.state.scenarioData}\r\n            activeEntry={this.state.activeEntry}\r\n            updateActiveEntry={this.updateActiveEntry}\r\n            addEntry={this.addEntry}\r\n            deleteEntry={this.deleteEntry}\r\n            oneEntryLeft={this.state.scenarioData.length === 1}\r\n          />\r\n          <PlayToolbarComponent\r\n            playing={this.state.playing}\r\n            updatePlaying={this.updatePlaying}\r\n            playTimeline={this.playTimeline}\r\n            pausePlaying={this.pausePlaying}\r\n            stopPlaying={this.stopPlaying}\r\n            playSpeed={this.state.playSpeed}\r\n            changePlaySpeed={this.changePlaySpeed}\r\n            themeDict={this.state.themeDict.other}\r\n          />\r\n          <ColorBarComponent\r\n            ref={this.colorBarRef}\r\n            themeDict={this.state.themeDict.other}\r\n            getColorLabel={this.getColorLabel}\r\n            updateLegendLabel={this.updateLegendLabel}\r\n          />\r\n          <MapComponent\r\n            activeEntry={this.state.activeEntry}\r\n            getRegionColorByIndex={this.getRegionColorByIndex}\r\n            themeDict={this.state.themeDict.other}\r\n            baseMap={this.baseMap}\r\n            key={this.state.mapKey}\r\n            assignRegions={this.assignRegions}\r\n            lassoSelecting={this.state.lassoSelecting}\r\n            updateLassoSelecting={this.updateLassoSelecting}\r\n            processRegionHoveredOn={this.processRegionHoveredOn}\r\n            processRegionHoveredOut={this.processRegionHoveredOut}\r\n            updatePicking={this.updatePicking}\r\n            picking={this.state.picking}\r\n            same={this.state.same}\r\n            assignSameColor={this.assignSameColor}\r\n            setColorBarColor={this.setColorBarColor}\r\n            updateMarkerData={this.updateMarkerData}\r\n            getMarkerData={this.getMarkerData}\r\n            ref={this.mapRef}\r\n          />\r\n        </div>\r\n      </ThemeProvider>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withStyles(useStyles)(App);","import { saveAs } from 'file-saver';\r\n\r\n// Expects an generic javascript object, one that is compatible with JSON.stringify and reading\r\nexport default function saveScenario(obj) {\r\n    const blob = new Blob([JSON.stringify(obj)], {type: \"application/json;charset=utf-8\"});\r\n    saveAs(blob, \"save.json\");\r\n};","// Returns the number in the array after the first occurrence of specified number, wrapping to start if reached end of array.\r\n// Returns null if the number is not in the array\r\nexport default function nextNumInList(number, array) {\r\n  const numberIndex = array.indexOf(number);\r\n  const nextIndex = (numberIndex + 1) % array.length;\r\n  return array[nextIndex];\r\n}","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\n\r\nReactDOM.render(\r\n  <App />,\r\n  document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}